<?xml version="1.0" encoding="UTF-8"?>
<document signature="Hero Lab Data">
  <fileconstants thingidrequirement="PU"></fileconstants>
  <thing id="cHelpPU0" name="Aegis" compset="Class" uniqueness="unique">
    <fieldval field="cHDSides" value="10"/>
    <fieldval field="cAbbr" value="Aeg"/>
    <fieldval field="cSkills" value="4"/>
    <fieldval field="srcPageNum" value="28"/>
    <fieldval field="srcBookInf" value="Ultimate Psionics"/>
    <fieldval field="cSCRNumDce" value="2"/>
    <fieldval field="cSCRDceSiz" value="6"/>
    <fieldval field="cSCRMult" value="10"/>
    <arrayval field="cPsiPPTot" index="5" value="9"/>
    <arrayval field="cPsiPPTot" index="6" value="11"/>
    <arrayval field="cPsiPPTot" index="7" value="14"/>
    <arrayval field="cPsiPPTot" index="8" value="17"/>
    <arrayval field="cPsiPPTot" index="9" value="20"/>
    <arrayval field="cPsiPPTot" index="10" value="24"/>
    <arrayval field="cPsiPPTot" index="11" value="28"/>
    <arrayval field="cPsiPPTot" index="12" value="32"/>
    <arrayval field="cPsiPPTot" index="13" value="37"/>
    <arrayval field="cPsiPPTot" index="14" value="42"/>
    <arrayval field="cPsiPPTot" index="15" value="47"/>
    <arrayval field="cPsiPPTot" index="16" value="52"/>
    <arrayval field="cPsiPPTot" index="17" value="58"/>
    <arrayval field="cPsiPPTot" index="18" value="64"/>
    <arrayval field="cPsiPPTot" index="19" value="70"/>
    <arrayval field="cPsiPPTot" index="0" value="1"/>
    <arrayval field="cPsiPPTot" index="1" value="2"/>
    <arrayval field="cPsiPPTot" index="2" value="3"/>
    <arrayval field="cPsiPPTot" index="3" value="5"/>
    <arrayval field="cPsiPPTot" index="4" value="7"/>
    <usesource source="pPsiUn"/>
    <tag group="Classes" tag="Aegis" name="Aegis"/>
    <tag group="Psionics" tag="Class"/>
    <tag group="ClassSkill" tag="skAcrobat"/>
    <tag group="ClassSkill" tag="Craft"/>
    <tag group="ClassSkill" tag="Profession"/>
    <tag group="ClassSkill" tag="skPUAhypno"/>
    <tag group="ClassSkill" tag="skClimb"/>
    <tag group="ClassSkill" tag="skFly"/>
    <tag group="ClassSkill" tag="skIntim"/>
    <tag group="ClassSkill" tag="skKnowEng"/>
    <tag group="ClassSkill" tag="skPUKnwPsi"/>
    <tag group="ClassSkill" tag="skSpellcr"/>
    <tag group="ClassSkill" tag="skSwim"/>
    <tag group="ClassSkill" tag="skUseMagic"/>
    <tag group="cFort" tag="Good"/>
    <tag group="cRef" tag="Poor"/>
    <tag group="cWill" tag="Good"/>
    <tag group="cAttack" tag="Good"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="cPUAegHelp"></bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="19"/>
      </bootstrap>
    <bootstrap thing="cPUMastCr">
      <autotag group="ClSpecWhen" tag="5"/>
      </bootstrap>
    <bootstrap thing="cPUCanniSu">
      <autotag group="ClSpecWhen" tag="12"/>
      </bootstrap>
    <bootstrap thing="cPUCanniSu">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="cPUCanniSu">
      <autotag group="ClSpecWhen" tag="16"/>
      </bootstrap>
    <bootstrap thing="cPUCanniSu">
      <autotag group="ClSpecWhen" tag="18"/>
      </bootstrap>
    <bootstrap thing="cPUCanniSu">
      <autotag group="ClSpecWhen" tag="20"/>
      </bootstrap>
    <bootstrap thing="cPUPerfMer">
      <autotag group="ClSpecWhen" tag="20"/>
      </bootstrap>
    <bootstrap thing="cPUAugSuit">
      <autotag group="ClSpecWhen" tag="4"/>
      </bootstrap>
    <bootstrap thing="cPUAugSuit">
      <autotag group="ClSpecWhen" tag="8"/>
      </bootstrap>
    <bootstrap thing="cPUAugSuit">
      <autotag group="ClSpecWhen" tag="12"/>
      </bootstrap>
    <bootstrap thing="cPUAugSuit">
      <autotag group="ClSpecWhen" tag="16"/>
      </bootstrap>
    <bootstrap thing="cPUAugSuit">
      <autotag group="ClSpecWhen" tag="20"/>
      </bootstrap>
    <bootstrap thing="cPUAstrRep">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="cPUCraftsm">
      <autotag group="ClSpecWhen" tag="2"/>
      </bootstrap>
    <bootstrap thing="cPUCraftsm">
      <autotag group="ClSpecWhen" tag="6"/>
      </bootstrap>
    <bootstrap thing="cPUCraftsm">
      <autotag group="ClSpecWhen" tag="10"/>
      </bootstrap>
    <bootstrap thing="cPUCraftsm">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="cPUCraftsm">
      <autotag group="ClSpecWhen" tag="18"/>
      </bootstrap>
    <bootstrap thing="cPUAstSuit">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="cPUAegDR">
      <autotag group="ClSpecWhen" tag="2"/>
      </bootstrap>
    <bootstrap thing="cPUAegDR">
      <autotag group="ClSpecWhen" tag="5"/>
      </bootstrap>
    <bootstrap thing="cPUAegDR">
      <autotag group="ClSpecWhen" tag="8"/>
      </bootstrap>
    <bootstrap thing="cPUAegDR">
      <autotag group="ClSpecWhen" tag="11"/>
      </bootstrap>
    <bootstrap thing="cPUAegDR">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="cPUAegDR">
      <autotag group="ClSpecWhen" tag="17"/>
      </bootstrap>
    <bootstrap thing="cPUAegDR">
      <autotag group="ClSpecWhen" tag="20"/>
      </bootstrap>
    <bootstrap thing="cPUInvigSu">
      <autotag group="ClSpecWhen" tag="3"/>
      </bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="3"/>
      </bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="5"/>
      </bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="7"/>
      </bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="9"/>
      </bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="11"/>
      </bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="13"/>
      </bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="15"/>
      </bootstrap>
    <bootstrap thing="cPUReconfi">
      <autotag group="ClSpecWhen" tag="17"/>
      </bootstrap>
    <bootstrap thing="fArmLight"></bootstrap>
    <bootstrap thing="fArmShield"></bootstrap>
    <bootstrap thing="fWepMart"></bootstrap>
    <bootstrap thing="fSimple"></bootstrap>
    <link linkage="psiattr" thing="aINT"/>
    <eval phase="PostLevel" priority="500"><![CDATA[
      ~ Set Aegis level into Aegis Helper pick &
      hero.childfound[cPUAegHelp].field[S2ClsLevel].value += field[cTotalLev].value]]>
      <before name="Set Aegis Base Points"/>
      </eval>
    </thing>
  <thing id="cPUAegis" name="Aegis" description="While the shaper is the master of manipulating ectoplasm and creating any manner of item, the aegis has learned to take ectoplasm and form it into a suit to be worn around his body, granting him a variety of benefits.\n\nThe aegis can shape his astral suit into several different forms and is capable of altering its abilities to suit his needs.\n\n{b}Role:{/b} An aegis is a front-line combatant. His astral suit allows him significant flexibility in handling combat and non-combat situations, and his defensive abilities are considerable.\n\n{b}Alignment:{/b} Any." compset="ClassLevel" maxlimit="20">
    <usesource source="pPsiUn"/>
    <tag group="ClassType" tag="Normal"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="cHelpPU0"></bootstrap>
    <link linkage="helper" thing="cHelpPU0"/>
    <eval phase="First" priority="50"><![CDATA[
      ~ Assign Class helper tag very early on the hero for
      ~ testing on the Bootstrap armor Thing. &
      perform hero.assign[Custom.AegisLvls]]]></eval>
    </thing>
  <thing id="cfgPUAstSu" name="Astral Suit" compset="Configure" uniqueness="unique">
    <fieldval field="cfgObject1" value="Astral Suit"/>
    <fieldval field="cfgObject2" value="Customization"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="StandardDC" tag="aINT"/>
    <tag group="abCategory" tag="PUAegisCus" name="Aegis Customization"/>
    <eval phase="PostLevel" priority="15000" name="Astral Suit Configurable"><![CDATA[
      ~ Set focus to Aegis Helper Pick &
      perform hero.childfound[cPUAegHelp].setfocus
      doneif (state.isfocus = 0)

      ~ Set Astral Suit Level from Aegis Helper &
      field[cfgLevel].value += focus.field[abValue].value

      ~ Set Configurable points from Aegis Helper.
      ~ abValue2 is Bonus points and abValue3 is the Base Points.
      field[cfgMax2].value += focus.field[abValue2].value + focus.field[abValue3].value]]>
      <after name="Set Aegis Base Points"/>
      </eval>
    <eval phase="Final" priority="999999" name="Astral Suit Expressions"><![CDATA[
      ~ Change the Customiazation expression to include Ability Category tags
      ~ NOTE: This script assumes at least ONE abCategory.? tag exists on the configurable
      ~       at the time that it runs.
      field[cfgAllow2].text = "(" & field[cfgAllow2].text & ") | (" & tagids[abCategory.?,"|"] & ")"]]></eval>
    </thing>
  <thing id="cPUAegHelp" name="Aegis Array Helper" description="This helper pick holds Aegis Suit Customization points and total points." compset="S2GenAry" uniqueness="useronce">
    <comment>S2Array = Points per level; abValue = Suit Level; abValue2 = Bonus/Penalty points; abValue3 = Configurable points.</comment>
    <arrayval field="S2Array" index="0" value="3"/>
    <arrayval field="S2Array" index="1" value="4"/>
    <arrayval field="S2Array" index="2" value="5"/>
    <arrayval field="S2Array" index="3" value="7"/>
    <arrayval field="S2Array" index="4" value="8"/>
    <arrayval field="S2Array" index="5" value="9"/>
    <arrayval field="S2Array" index="6" value="10"/>
    <arrayval field="S2Array" index="7" value="11"/>
    <arrayval field="S2Array" index="8" value="13"/>
    <arrayval field="S2Array" index="9" value="14"/>
    <arrayval field="S2Array" index="10" value="15"/>
    <arrayval field="S2Array" index="11" value="16"/>
    <arrayval field="S2Array" index="12" value="17"/>
    <arrayval field="S2Array" index="13" value="19"/>
    <arrayval field="S2Array" index="14" value="20"/>
    <arrayval field="S2Array" index="15" value="21"/>
    <arrayval field="S2Array" index="16" value="22"/>
    <arrayval field="S2Array" index="17" value="23"/>
    <arrayval field="S2Array" index="18" value="25"/>
    <arrayval field="S2Array" index="19" value="26"/>
    <eval phase="PostLevel" priority="12000" name="Set Aegis Base Points"><![CDATA[
      ~ Set abValue for backwards compatiblity &
      field[abValue].value += field[S2ClsLevel].value
      field[S2AryLevel].value = field[S2ClsLevel].value - 1

      ~ Set base customization points into Value Three
      field[abValue3].value += field[S2Array].arrayvalue[field[S2AryLevel].value]]]></eval>
    </thing>
  <thing id="cPUAstrRep" name="Astral Repair" description="An aegis is capable of repairing mundane items, restoring 2 hit points of damage to the touched item as a standard action usable at will. If the object has the broken condition, this condition is removed if the object is restored to at least half its original hit points. All of the pieces of an object must be present for this ability to function. This ability has no effect on objects that have been warped or otherwise transmuted, but it can still repair damage done to such items." compset="ClSpecial">
    <fieldval field="abValue" value="2"/>
    <tag group="AbilType" tag="PsiLike"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="Helper" tag="SpecUp"/>
    <bootstrap thing="puAstRep1">
      <containerreq phase="First" priority="2500">!AbReplace.cPUAstrRep</containerreq>
      <autotag group="Usage" tag="AtWill"/>
      <autotag group="Helper" tag="PsiLike"/>
      </bootstrap>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ If we've been Disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Set the total amount of points repaired
      perform hero.childfound[puAstRep1].assignstr["Value." & field[abValue].value]]]></eval>
    </thing>
  <thing id="cPUAstSuit" name="Form Astral Suit" description="Every aegis learns to draw forth ectoplasm and form an astral suit around their form. The aegis can select from three different types when forming his astral suit – skin, armor, or juggernaut. An aegis is always considered to be proficient with his astral suit, even if he does not have the appropriate armor proficiency. The amount of time forming this astral suit takes depends on the type of suit being formed. Different astral suit forms grant different free customizations. These free customizations never count against the aegis’s total number of customization points spent on his astral suit.\n\nThe aegis chooses the appearance of his astral suit, although its shape must reflect the selections the aegis has chosen: astral skin would cover the aegis like a {i}psychoactive skin{/i}, astral juggernaut would appear to cover the aegis like plate armor, etc.\n\nAn astral suit can be dismissed as a free action.\n\nAn astral suit does not function in areas where psionics do not work, such as a {i}null psionics field{/i}. {i}Dismiss ectoplasm{/i} can be used against an astral suit; treat the manifester level as the aegis’s class level, although the aegis can simply form his astral suit again on his next turn." compset="ClSpecial" summary="Form an astral suit around your body.">
    <fieldval field="actName" value="Wearing Astral Suit"/>
    <tag group="SpecType" tag="Defense"/>
    <tag group="User" tag="Activation"/>
    <tag group="AbilType" tag="Super"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="cfgPUAstSu">
      <containerreq phase="First" priority="450">!AbReplace.cPUAstSuit</containerreq>
      </bootstrap>
    <eval phase="First" priority="90"><![CDATA[
      ~if we've been replaced, get out now
      doneif (tagis[Helper.SpcReplace] <> 0)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)
      ~ If ability not active get out now!
      doneif (field[abilActive].value = 0)

      ~ Set a hero tag so we can test that we are active by other Picks
      ~ at a very early timing for bootstraps.
      perform hero.assign[Custom.WearAstS]]]></eval>
    <eval phase="PostLevel" priority="10000" index="2"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      field[abValue].value += field[xCount].value

      ~ The following should only happen once on the first copy
      doneif (tagis[Helper.FirstCopy] = 0)

      ~ Increase the number of allowed Astral Suits
      hero.childfound[cfgPUAstSu].field[cfgMax1].value += field[abValue].value]]></eval>
    </thing>
  <thing id="cPUCraftsm" name="Craftsman" description="Beginning at 2nd level, an aegis gains a +1 bonus to any one Craft skill of his choice. At 6th level and every four levels thereafter, this bonus increases by 1." compset="ClSpecial" summary="Gain a bonus to any one Craft skill of your choice.">
    <tag group="ChooseSrc1" tag="Hero"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & signed(field[xIndex].value)

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      field[abValue].value += field[xCount].value
      field[livename].text = field[thingname].text & " " & signed(field[abValue].value)

      ~ The following should only happen once on the first copy
      doneif (tagis[Helper.FirstCopy] = 0)

      ~ Set custom expression only on the first class special
      field[usrCandid1].text = "component.BaseSkill & Helper.SkCatCraft"

      ~ If nothing chosen get out now!
      doneif (field[usrChosen1].ischosen = 0)

      ~ Increase selected craft skill
      field[usrChosen1].chosen.field[Bonus].value += field[abValue].value]]></eval>
    </thing>
  <thing id="cPUAegDR" name="Damage Reduction" description="Starting at 2nd level, when an aegis is wearing his astral suit, he gains damage reduction 2/-, regardless of what type of astral suit he is wearing. At 5th level and every three levels thereafter, this damage reduction improves by 1." compset="ClSpecial" summary="Gain DR/- when wearing your Astral Suit.">
    <fieldval field="abValue" value="1"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="SpecType" tag="DR"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10100"><![CDATA[
      var ListValue as number
      ListValue = field[xIndex].value + 1
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & ListValue & "/-"

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      field[abValue].value += field[xCount].value
      field[livename].text = field[thingname].text & " " & field[abValue].value & "/-"

      ~ The following should only happen once on the first copy
      doneif (tagis[Helper.FirstCopy] = 0)
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ If we have a multiplier value then use it
      If (field[abValue2].value <> 0) Then
        field[abValue].value = field[abValue].value * field[abValue2].value
      Endif

      ~ Apply DR to hero
      #applydr[xDamRd,field[abValue].value]]]></eval>
    </thing>
  <thing id="cPUInvigSu" name="Invigorating Suit" description="An aegis of at least 3rd level wearing his astral suit gains a +4 bonus on the following checks and saves: Swim checks made to resist nonlethal damage from exhaustion; Constitution checks made to continue running; Constitution checks made to avoid nonlethal damage from a forced march; Constitution checks made to hold breath; Constitution checks made to avoid nonlethal damage from starvation or thirst; Fortitude saves made to avoid nonlethal damage from hot or cold environments; and Fortitude saves made to resist damage from suffocation." compset="ClSpecial" summary="Gain a bonus to Consitution checks and Fortitude saves.">
    <fieldval field="abValue" value="4"/>
    <tag group="AbilType" tag="Super"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="50000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)
      ~ The following should only happen once on the first copy
      doneif (tagis[Helper.FirstCopy] = 0)
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      #situational[hero.childfound[skSwim],signed(field[abValue].value) & " to resist nonlethal damage from exhaustion",field[name].text]
      #situational[hero.childfound[aCON],signed(field[abValue].value) & " to continue running",field[name].text]
      #situational[hero.childfound[aCON],signed(field[abValue].value) & " to avoid nonlethal damage from a forced march",field[name].text]
      #situational[hero.childfound[aCON],signed(field[abValue].value) & " to hold breath",field[name].text]
      #situational[hero.childfound[aCON],signed(field[abValue].value) & " to avoid nonlethal damage from starvation or thirst",field[name].text]
      #situational[hero.childfound[svFort],signed(field[abValue].value) & " to avoid nonlethal damage from hot or cold environments",field[name].text]
      #situational[hero.childfound[svFort],signed(field[abValue].value) & " to resist damage from suffocation",field[name].text]]]></eval>
    </thing>
  <thing id="cPUReconfi" name="Reconfigure" description="Starting at 3rd level, an aegis can reconfigure up to his Intelligence modifier in customization points on his astral suit once per day as a standard action. Every two levels thereafter, he can use this ability an additional time per day." compset="ClSpecial" summary="Reconfigure up to your Int mod in customization points.">
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Day"/>
    <tag group="SbNamePar" tag="IncUses"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="10000"><![CDATA[
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & field[xIndex].value & " point"

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Set amount of customization
      field[abValue].value += #attrbonus[aINT]
      ~ Set number of uses per day
      field[trkMax].value += field[xCount].value

      ~ Show number of customization points
      field[livename].text = field[thingname].text & " (" & field[abValue].value & " customization points)"]]></eval>
    </thing>
  <thing id="cPUAugSuit" name="Augment Suit" description="An aegis learns how to infuse his astral suit with his psionic power, augmenting the capacity of his suit. Beginning at 4th level, the aegis may spend up to one power point per four class levels to customize his Astral Suit, gaining one temporary customization point for each power point spent. \n\nThis ability, activated as a standard action, lasts for a number of rounds equal to the aegis’ Intelligence modifier.\n\nActivating this ability again, while already in use, immediately causes the previous duration to end. \n\nAn aegis may end the duration as a free action at any time." compset="ClSpecial" summary="Spend power points to gain temp customization points.">
    <tag group="AbilType" tag="Super"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Rounds"/>
    <tag group="User" tag="Activation"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & field[xIndex].value & " PP"

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Set number of power points
      field[abValue].value += field[xCount].value
      field[livename].text = field[thingname].text & " (" & field[abValue].value & " PP)"

      ~ The following should only happen once on the first copy
      doneif (tagis[Helper.FirstCopy] = 0)
      ~ If not activated get out now!
      doneif (field[abilActive].value = 0)

      ~ Give temp customization points
      #value2[cPUAegHelp] += field[abValue].value]]></eval>
    <eval phase="PostAttr" priority="10000" index="2"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Rounds of use equal to Int mod
      field[trkMax].value += #attrmod[aINT]]]></eval>
    </thing>
  <thing id="cPUMastCr" name="Master Craftsman" description="At 5th level, an aegis gains the Master Craftsman feat as a bonus feat. He must still meet the prerequisites of the feat in order to gain its benefits." compset="ClSpecial" summary="Gain the Master Craftsman feat as a bonus feat.">
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="fMasCraft">
      <containerreq phase="First" priority="500"><![CDATA[count:Custom.AegisLvls >= 5 & !AbReplace.cPUMastCr]]></containerreq>
      </bootstrap>
    </thing>
  <thing id="cPUCanniSu" name="Cannibalize Suit" description="Starting at 12th level, an aegis learns to convert the psionic energy used to create his suit into healing power. Once per day as a standard action, he can dismiss his astral suit and heal a number of hit points equal to his customization pool. The aegis cannot reform his suit again for one minute after using this ability. Every two levels thereafter, the aegis can use this ability an additional time per day. Additional customization points gained from Augment Suit are not counted for this ability." compset="ClSpecial" summary="Dismiss astral suit to heal.">
    <tag group="Usage" tag="Day"/>
    <tag group="User" tag="Tracker"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="12050"><![CDATA[
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & field[xIndex].value & "/day"

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Uses per day
      field[trkMax].value += field[xCount].value

      ~ Healing amout is BASE point value
      field[livename].text = field[thingname].text & " (" & #value3[cPUAegHelp] & " healing)"]]>
      <after name="Set Aegis Base Points"/>
      </eval>
    </thing>
  <thing id="cPUPerfMer" name="Perfect Merger" description="An aegis of 20th level has learned to become one with his suit. His suit cannot be dispelled or removed against his will by any means, although his astral suit ability still does not function within areas where psionics do not work, such as a {i}null psionics field{/i}.\n\nIn addition, the aegis can spend two daily uses of his reconfigure ability, to alter all of the customizations on his astral suit.\n\nFinally, once per day, the aegis can boost his cannibalize suit ability, healing all of his hit point damage, although he cannot reform his suit for ten minutes after using this ability, rather than the standard one minute." compset="ClSpecial" summary="Cannibalize suit to heal all damage.">
    <fieldval field="trkMax" value="1"/>
    <tag group="Usage" tag="Day"/>
    <tag group="User" tag="Tracker"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      hero.childfound[cPUReconfi].field[DescAppend].text = "{b}" & field[thingname].text & ":{/b} Spend two daily uses of reconfigure ability, to alter all of the customizations on his astral suit."]]></eval>
    </thing>
  <thing id="rcPUaSkin" name="Astral Skin" description="When formed in this way, an astral suit resembles a {i}psychoactive skin{/i}. Forming an astral suit into this form takes a swift action. The aegis gains no armor bonus from his astral suit when worn in this fashion, but he gains the following free customizations: speed (2), nimble. At 2nd level, the aegis gains the evasion customization as a free customization when the astral suit is in astral skin form. At 12th level, the aegis gains the improved evasion customization as a free customization when the astral suit is in astral skin form. An astral suit in this form does not count as any type of armor, but does count as a {i}psychoactive skin{/i} and follows all the rules of a {i}psychoactive skin{/i}." compset="RaceCustom" summary="AC +0; Free customizations: speed (2), nimble.">
    <usesource source="pPsiUn"/>
    <tag group="AllowRCust" tag="cfgPUAstSu"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="rcPUaSpeed">
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="rcPUaSpeed">
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="rcPUaNimbl">
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="rcPUaEvade">
      <containerreq phase="First" priority="500"><![CDATA[count:Custom.AegisLvls >= 2]]></containerreq>
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="rcPUaIEvad">
      <containerreq phase="First" priority="500"><![CDATA[count:Custom.AegisLvls >= 12]]></containerreq>
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <eval phase="First"><![CDATA[
      ~ Set tags on hero &
      perform hero.assign[Custom.HasAstSkin]
      perform hero.assign[Custom.ASChosen]]]></eval>
    </thing>
  <thing id="rcPUaSpeed" name="Speed" description="The aegis&apos;s base land speed is increased by 5 feet. This customization can be selected up to five times.{br}{br}Its effects stack." compset="CustomSpec" summary="Increase speed by +5ft.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="SpecType" tag="Movement"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set Helper.FirstCopy &
      call X1SetFirst]]></eval>
    <eval phase="PostLevel" priority="10050" index="2"><![CDATA[
      ~ Set feet bonus into first value
      field[abValue].value += maximum(field[abValue5].value * 5, 5)
      field[abSumm].text = "Increase land speed by " & signed(field[abValue].value) & " ft while wearing astral suit."

      ~ If we are not the first copy, get out now! &
      doneif (tagis[Helper.FirstCopy] = 0)
      ~ If not wearing astral suit, get out now!
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Bonus to Speed
      hero.child[Speed].field[tSpeed].value += field[abValue].value]]></eval>
    <prereq message="You may not have more than 5 copies of this ability.">
      <validate><![CDATA[
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaSpeed] <= 5)

        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaSpeed] < 5)
        endif]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaNimbl" name="Nimble" description="The aegis gains a +2 enhancement bonus to Dexterity while he is wearing his astral suit. This customization can be selected a second time beginning at 5th level, and a third time starting at 10th level. Each subsequent time it is taken, the enhancement bonus to Dexterity is increased by +2." compset="CustomSpec" summary="+2 enhancement bonus to Dexterity while wearing astral suit.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set Helper.FirstCopy &
      call X1SetFirst

      ~ If we're not bootstrapped to something, get out now!
      doneif (isroot = 0)

      ~ Using OverCrit tags for getting this ability "free"
      perform hero.pushtags[OverCrit.?]]]></eval>
    <eval phase="PostLevel" priority="10050" index="2"><![CDATA[
      ~ If we are not the first copy, get out now!
      doneif (tagis[Helper.FirstCopy] = 0)

      ~ Bonus is 2 times the number of times this ability has
      ~ been taken.
      field[abValue].value += field[abValue5].value * 2
      field[livename].text = field[thingname].text & " (" & signed(field[abValue].value) & " Dex)"
      field[abSumm].text = signed(field[abValue].value) & " enhancement bonus to Dexterity while wearing astral suit."

      ~ If we're not wearing astral suit, get out now!
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Increase Dex bonus
      #enhancementbonus[hero.child[aDEX], field[abValue].value]]]></eval>
    <prereq message="">
      <validate><![CDATA[
        var allowed as number
        var taken as number
        allowed = 1
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        ~ At level 5 can take this again
        If (levels >= 5) Then
          allowed += 1
        Endif
        ~ At level 10 can take this again
        If (levels >= 10) Then
          allowed += 1
        Endif

        ~ Count the number of times manually added
        taken = tagcount[HasAbility.rcPUaNimbl] - tagcount[OverCrit.rcPUaNimbl]

        ~ if we're a pick, then there must be 3 or fewer copies of
        ~ this ability
        If (@ispick <> 0) Then
          validif (taken <= allowed)

        ~ otherwise, look for fewer, since we're adding this
        Else
          validif (taken < allowed)
        Endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaEvade" name="Evasion" description="As long as the aegis is wearing the astral suit, if the aegis is subjected to an attack that normally allows a Reflex save for half damage, he takes no damage if he makes a successful saving throw. The aegis must be at least 2nd level before selecting this customization." compset="CustomSpec" summary="Gain evasion ability while wearing astral suit." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="SpecType" tag="Defense"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="raEvasion">
      <containerreq phase="First" priority="500">Custom.WearAstS</containerreq>
      </bootstrap>
    <prereq message="Aegis level 2+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 2)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaArmor" name="Astral Armor" description="When formed into astral armor, an astral suit resembles masterwork chainmail and is treated as such for all mechanical purposes. Should the aegis be wearing armor when forming his astral suit in this fashion, the astral suit encloses the armor and the aegis gains the benefits of only his astral suit and not that from his armor, even if his armor would confer better benefits. Forming an astral suit into this form takes a move action. The aegis gains the following free customizations: brawn, improved damage. At 2nd level, the aegis gains the flexible suit customization as a free customization when the astral suit is in astral armor form. At 8th level, the astral suit resembles and is treated as a masterwork breastplate for all mechanical purposes." compset="RaceCustom" summary="Chainmail/Breastplate; Free customizations: brawn, improved damage." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="AllowRCust" tag="cfgPUAstSu"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="rcPUaImDmg">
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="rcPUaBrawn">
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="rcPUaFlexS">
      <containerreq phase="First" priority="500"><![CDATA[count:Custom.AegisLvls >= 2]]></containerreq>
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="mPUAstArCh">
      <containerreq phase="First" priority="100"><![CDATA[count:Custom.AegisLvls < 8 & Custom.WearAstS]]></containerreq>
      </bootstrap>
    <bootstrap thing="mPUAstArBr">
      <containerreq phase="First" priority="100"><![CDATA[count:Custom.AegisLvls >= 8 & Custom.WearAstS]]></containerreq>
      </bootstrap>
    <eval phase="First"><![CDATA[
      ~ Set tags on hero &
      perform hero.assign[Custom.HasAstSkin]
      perform hero.assign[Custom.ASChosen]]]></eval>
    </thing>
  <thing id="mPUAstArCh" name="Astral Chainmail" description="When formed into astral armor, an astral suit resembles masterwork chainmail and is treated as such for all mechanical purposes. Should the aegis be wearing armor when forming his astral suit in this fashion, the astral suit encloses the armor and the aegis gains the benefits of only his astral suit and not that from his armor, even if his armor would confer better benefits. Forming an astral suit into this form takes a move action." compset="Armor">
    <fieldval field="gWeight" value="40"/>
    <usesource source="pPsiUn"/>
    <tag group="Custom" tag="AstArmor"/>
    <tag group="EquipType" tag="Metal"/>
    <tag group="ArmorCateg" tag="Gauntlets"/>
    <tag group="ArmorCateg" tag="Slows"/>
    <tag group="ArmorCheck" tag="5"/>
    <tag group="ArmorClass" tag="Medium"/>
    <tag group="ArmorMaxDx" tag="2"/>
    <tag group="ArmorAC" tag="6"/>
    <tag group="ArmorArcFl" tag="30"/>
    <tag group="Helper" tag="AlwaysMast"/>
    <tag group="Helper" tag="AutoEquip"/>
    <tag group="Helper" tag="Helper"/>
    <tag group="Helper" tag="Proficient"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="20000"><![CDATA[
      ~ Apply astral suit bonuses &
      call PUAstBonus]]></eval>
    </thing>
  <thing id="mPUAstArBr" name="Astral Breastplate" description="When formed into astral armor, an astral suit resembles masterwork breastplate and is treated as such for all mechanical purposes. Should the aegis be wearing armor when forming his astral suit in this fashion, the astral suit encloses the armor and the aegis gains the benefits of only his astral suit and not that from his armor, even if his armor would confer better benefits. Forming an astral suit into this form takes a move action." compset="Armor">
    <fieldval field="gWeight" value="30"/>
    <usesource source="pPsiUn"/>
    <tag group="Custom" tag="AstArmor"/>
    <tag group="EquipType" tag="Metal"/>
    <tag group="ArmorCateg" tag="Slows"/>
    <tag group="ArmorCheck" tag="4"/>
    <tag group="ArmorClass" tag="Medium"/>
    <tag group="ArmorMaxDx" tag="3"/>
    <tag group="ArmorAC" tag="6"/>
    <tag group="ArmorArcFl" tag="25"/>
    <tag group="Helper" tag="AutoEquip"/>
    <tag group="Helper" tag="AlwaysMast"/>
    <tag group="Helper" tag="MatCstSuit"/>
    <tag group="Helper" tag="PieceUpMat"/>
    <tag group="Helper" tag="Helper"/>
    <tag group="Helper" tag="Proficient"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="20000"><![CDATA[
      ~ Apply astral suit bonuses &
      call PUAstBonus]]></eval>
    </thing>
  <thing id="rcPUaImDmg" name="Improved Damage" description="The aegis&apos;s melee attacks deal additional damage. If wielding a two-handed weapon, the aegis deals 3 additional points of damage on a successful hit. If wielding a one-handed weapon, the aegis deals 2 additional points of damage on a successful hit. If wielding a light weapon, the aegis deals 1 additional point of damage on a successful hit. If dual-wielding, each weapon is affected separately." compset="CustomSpec" summary="Gain a dmg bonus based on weapon type." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Set focus to the Damage helper pick
      perform hero.childfound[Damage].setfocus
      doneif (state.isfocus = 0)

      ~ Give damage bonus based on weapon type
      focus.field[tDamLight].value += 1
      focus.field[tDamOne].value += 2
      focus.field[tDamTwo].value += 3]]></eval>
    </thing>
  <thing id="rcPUaBrawn" name="Brawn" description="The aegis gains a +2 enhancement bonus to Strength while he is wearing his astral suit. This customization can be selected a second time beginning at 5th level, and a third time starting at 10th level. Each subsequent time it is taken, the enhancement bonus to Strength is increased by +2." compset="CustomSpec" summary="+2 enhancement bonus to Strength while wearing astral suit.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set Helper.FirstCopy &
      call X1SetFirst

      ~ If we're not bootstrapped to something, get out now!
      doneif (isroot = 0)

      ~ Using OverCrit tags for getting this ability "free"
      perform hero.pushtags[OverCrit.?]]]></eval>
    <eval phase="PostLevel" priority="10050" index="2"><![CDATA[
      ~ If we are not the first copy, get out now!
      doneif (tagis[Helper.FirstCopy] = 0)

      ~ Bonus is 2 times the number of times this ability has
      ~ been taken.
      field[abValue].value += field[abValue5].value * 2
      field[livename].text = field[thingname].text & " (" & signed(field[abValue].value) & " Str)"
      field[abSumm].text = signed(field[abValue].value) & " enhancement bonus to Strength while wearing astral suit."

      ~ If we're not wearing astral suit, get out now!
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Increase Str bonus
      #enhancementbonus[hero.child[aSTR], field[abValue].value]]]></eval>
    <prereq message="">
      <validate><![CDATA[
        var allowed as number
        var taken as number
        allowed = 1
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        ~ At level 5 can take this again
        If (levels >= 5) Then
          allowed += 1
        Endif
        ~ At level 10 can take this again
        If (levels >= 10) Then
          allowed += 1
        Endif

        ~ Count the number of times manually added
        taken = tagcount[HasAbility.rcPUaBrawn] - tagcount[OverCrit.rcPUaBrawn]

        ~ if we're a pick, then there must be 3 or fewer copies of
        ~ this ability
        If (@ispick <> 0) Then
          validif (taken <= allowed)

        ~ otherwise, look for fewer, since we're adding this
        Else
          validif (taken < allowed)
        Endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaFlexS" name="Flexible Suit" description="The aegis&apos;s armor check penalty is reduced by 1 (to a minimum of 0). The aegis may also sleep in his astral suit without becoming fatigued, if he was not already able to do so (such as if in astral skin form)." compset="CustomSpec" summary="Astral suit armor check penalty is reduced by 1 (to a minimum of 0)." uniqueness="useronce">
    <comment>This ability is fully implemented. The procedure PUAstBonus handles the bonus logic.</comment>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="rcPUaJugge" name="Astral Juggernaut" description="When formed into astral juggernaut, an astral suit resembles masterwork half-plate and is treated as such for all mechanical purposes. Should the aegis be wearing armor when forming his astral suit in this fashion, the astral suit encloses the armor and the aegis gains the benefits of only his astral suit and not that from his armor, even if his armor would confer better benefits. Forming an astral suit into this form takes a full-round action. The aegis gains the following free customizations: fortification, hardy. At 2nd level, the aegis gains the stalwart customization as a free customization when the astral suit is in astral juggernaut form. At 7th level, the astral suit resembles and is treated as masterwork full plate for all mechanical purposes." compset="RaceCustom" summary="Half-Plate/Full Plate; Free customizations: fortification, hardy." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="AllowRCust" tag="cfgPUAstSu"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="rcPUaForti">
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="rcPUaHardy">
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="rcPUaStalw">
      <containerreq phase="First" priority="500"><![CDATA[count:Custom.AegisLvls >= 2]]></containerreq>
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="mPUAstArFP">
      <containerreq phase="First" priority="100"><![CDATA[count:Custom.AegisLvls >= 7 & Custom.WearAstS]]></containerreq>
      </bootstrap>
    <bootstrap thing="mPUAstArHP">
      <containerreq phase="First" priority="100"><![CDATA[count:Custom.AegisLvls < 7 & Custom.WearAstS]]></containerreq>
      </bootstrap>
    <eval phase="First"><![CDATA[
      ~ Set tags on hero &
      perform hero.assign[Custom.HasAstSkin]
      perform hero.assign[Custom.ASChosen]]]></eval>
    </thing>
  <thing id="mPUAstArFP" name="Astral Full plate" description="When formed into astral juggernaut, an astral suit resembles masterwork full plate and is treated as such for all mechanical purposes. Should the aegis be wearing armor when forming his astral suit in this fashion, the astral suit encloses the armor and the aegis gains the benefits of only his astral suit and not that from his armor, even if his armor would confer better benefits. Forming an astral suit into this form takes a full-round action." compset="Armor">
    <fieldval field="gWeight" value="50"/>
    <usesource source="pPsiUn"/>
    <tag group="Custom" tag="AstArmor"/>
    <tag group="ArmorAC" tag="9"/>
    <tag group="ArmorCateg" tag="Gauntlets"/>
    <tag group="ArmorCateg" tag="Slows"/>
    <tag group="ArmorCheck" tag="6"/>
    <tag group="ArmorClass" tag="Heavy"/>
    <tag group="ArmorMaxDx" tag="1"/>
    <tag group="ArmorArcFl" tag="35"/>
    <tag group="EquipType" tag="Metal"/>
    <tag group="Helper" tag="AutoEquip"/>
    <tag group="Helper" tag="AlwaysMast"/>
    <tag group="Helper" tag="Helper"/>
    <tag group="Helper" tag="Proficient"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="20000"><![CDATA[
      ~ Apply astral suit bonuses &
      call PUAstBonus]]></eval>
    </thing>
  <thing id="mPUAstArHP" name="Astral Half-plate" description="When formed into astral juggernaut, an astral suit resembles masterwork half-plate and is treated as such for all mechanical purposes. Should the aegis be wearing armor when forming his astral suit in this fashion, the astral suit encloses the armor and the aegis gains the benefits of only his astral suit and not that from his armor, even if his armor would confer better benefits. Forming an astral suit into this form takes a full-round action." compset="Armor">
    <fieldval field="gWeight" value="50"/>
    <usesource source="pPsiUn"/>
    <tag group="Custom" tag="AstArmor"/>
    <tag group="ArmorAC" tag="8"/>
    <tag group="ArmorCateg" tag="Gauntlets"/>
    <tag group="ArmorCateg" tag="Slows"/>
    <tag group="ArmorCheck" tag="7"/>
    <tag group="ArmorClass" tag="Heavy"/>
    <tag group="ArmorMaxDx" tag="0"/>
    <tag group="ArmorArcFl" tag="40"/>
    <tag group="EquipType" tag="Metal"/>
    <tag group="Helper" tag="AlwaysMast"/>
    <tag group="Helper" tag="AutoEquip"/>
    <tag group="Helper" tag="Proficient"/>
    <tag group="Helper" tag="Helper"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="20000"><![CDATA[
      ~ Apply astral suit bonuses &
      call PUAstBonus]]></eval>
    </thing>
  <thing id="rcPUaForti" name="Fortification" description="The aegis gains 25% chance to negate critical hits or sneak attacks (so damage is rolled normally instead). This does not stack with armor with the same special ability. This ability can be selected again starting at 8th level and at 12th level, increasing the chance to negate critical hits or sneak attacks by an additional 25% for every additional time it is taken." compset="CustomSpec" summary="25% chance to negate critical hits or sneak attacks.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="Helper" tag="SpecUp"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set Helper.FirstCopy &
      call X1SetFirst

      ~ If we're not bootstrapped to something, get out now!
      doneif (isroot = 0)

      ~ Using OverCrit tags for getting this ability "free"
      perform hero.pushtags[OverCrit.?]]]></eval>
    <eval phase="PostLevel" priority="10050" index="2"><![CDATA[
      ~ If we are not the first copy, get out now!
      doneif (tagis[Helper.FirstCopy] = 0)

      ~ Bonus is 2 times the number of times this ability has
      ~ been taken.
      field[abValue].value += field[abValue5].value * 25
      field[livename].text = field[thingname].text & " (" & field[abValue].value & " %)"
      field[abSumm].text = field[abValue].value & "% chance to negate critical hits or sneak attacks."

      ~ If we're not wearing astral suit, get out now!
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Apply Fortification to hero
      #applyfort[field[abValue].value]]]></eval>
    <prereq message="">
      <validate><![CDATA[
        var allowed as number
        var taken as number
        allowed = 1
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        ~ At level 5 can take this again
        If (levels >= 8) Then
          allowed += 1
        Endif
        ~ At level 10 can take this again
        If (levels >= 12) Then
          allowed += 1
        Endif

        ~ Count the number of times manually added
        taken = tagcount[HasAbility.rcPUaForti] - tagcount[OverCrit.rcPUaForti]

        ~ if we're a pick, then there must be 3 or fewer copies of
        ~ this ability
        If (@ispick <> 0) Then
          validif (taken <= allowed)

        ~ otherwise, look for fewer, since we're adding this
        Else
          validif (taken < allowed)
        Endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaHardy" name="Hardy" description="The aegis gains a +2 enhancement bonus to Constitution while he is wearing his astral suit. This customization can be selected a second time beginning at 5th level, and a third time starting at 10th level. Each subsequent time it is taken, the enhancement bonus to Constitution is increased by +2." compset="CustomSpec" summary="+2 enhancement bonus to Constitution while wearing astral suit.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set Helper.FirstCopy &
      call X1SetFirst

      ~ If we're not bootstrapped to something, get out now!
      doneif (isroot = 0)

      ~ Using OverCrit tags for getting this ability "free"
      perform hero.pushtags[OverCrit.?]]]></eval>
    <eval phase="PostLevel" priority="10050" index="2"><![CDATA[
      ~ If we are not the first copy, get out now!
      doneif (tagis[Helper.FirstCopy] = 0)

      ~ Bonus is 2 times the number of times this ability has
      ~ been taken.
      field[abValue].value += field[abValue5].value * 2
      field[livename].text = field[thingname].text & " (" & signed(field[abValue].value) & " Con)"
      field[abSumm].text = signed(field[abValue].value) & " enhancement bonus to Constitution while wearing astral suit."

      ~ If we're not wearing astral suit, get out now!
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Increase Dex bonus
      #enhancementbonus[hero.child[aCON], field[abValue].value]]]></eval>
    <prereq message="">
      <validate><![CDATA[
        var allowed as number
        var taken as number
        allowed = 1
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        ~ At level 5 can take this again
        If (levels >= 5) Then
          allowed += 1
        Endif
        ~ At level 10 can take this again
        If (levels >= 10) Then
          allowed += 1
        Endif

        ~ Count the number of times manually added
        taken = tagcount[HasAbility.rcPUaHardy] - tagcount[OverCrit.rcPUaHardy]

        ~ if we're a pick, then there must be 3 or fewer copies of
        ~ this ability
        If (@ispick <> 0) Then
          validif (taken <= allowed)

        ~ otherwise, look for fewer, since we're adding this
        Else
          validif (taken < allowed)
        Endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaStalw" name="Stalwart" description="As long as the aegis is wearing the astral suit, if the aegis is subjected to an attack that normally allows a Fortitude or Will save for a reduced or partial effect, he ignores the effect if he makes a successful saving throw.{br}{br}The aegis must be at least 2nd level before selecting this customization." compset="CustomSpec" summary="Ignore partial effects when making a Fort/Will save." uniqueness="useronce">
    <fieldval field="abText5" value="If save allows for a reduced or partial effect, then ignore the effect if you successfully save."/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="50000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Add situational notes to Will/Fort saves &
      #situational[hero.childfound[svWill],field[abText5].text,field[name].text]
      #situational[hero.childfound[svFort],field[abText5].text,field[name].text]]]></eval>
    <prereq message="Aegis level 2+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 2)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaDarkv" name="Darkvision" description="The aegis gains darkvision out to a range of 60 feet." compset="CustomSpec" uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="SpecType" tag="Sense"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="raDarkVis">
      <containerreq phase="First" priority="500">Custom.WearAstS</containerreq>
      <assignval field="abValue" value="60"/>
      </bootstrap>
    </thing>
  <thing id="rcPUaRngAt" name="Ranged Attack" description="The aegis gains the ability to propel a non-psionic crystal, formed from the astral suit, at a target as a ranged attack that deals 1d8 points of piercing damage and has a range increment of 30 ft. This attack can be used as part of a full attack, including using this attack for each attack in the full attack." compset="CustomSpec" summary="Gain a ranged attack." uniqueness="useronce">
    <fieldval field="abValue" value="1"/>
    <fieldval field="abValue2" value="8"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="Helper" tag="WeaponSpec"/>
    <tag group="wCategory" tag="RangeProj"/>
    <tag group="wType" tag="P"/>
    <tag group="wCritMin" tag="20"/>
    <tag group="wCritMult" tag="2"/>
    <tag group="wRangeInc" tag="30"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="500" name="Aegis Ranged Attack"><![CDATA[
      ~ Build fixed ranged damage dice with no bonus damage &
      If (field[abValue3].value = 0) Then
        field[wFixRanDam].text = field[abValue].value & "d" & field[abValue2].value

      ~ Include damage dice with bonus
      Else
        field[wFixRanDam].text = field[abValue].value & "d" & field[abValue2].value & signed(field[abValue3].value)
      Endif

      ~ Energy damage append info to weapon dmg
      If (tagis[PsiActEne.?] = 1) Then
        field[wFixRanDam].text &= " " & tagnames[PsiActEne.?]
      Endif]]></eval>
    </thing>
  <thing id="rcPUaEneBl" name="Energy Blast" description="The ranged attack gained from the ranged attack customization becomes imbued with psionic energy. The attack is now treated as a ranged touch attack and instead deals 1d6 points of damage of your active energy type, but requires a standard action to use and cannot be used as part of a full attack. This effect can be turned on or off as a move action. The aegis must be at least 4th level and have the ranged attack customization before selecting this customization." compset="CustomSpec" uniqueness="useronce">
    <fieldval field="actName" value="Move Action"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="User" tag="Activation"/>
    <eval phase="Final" priority="450"><![CDATA[
      ~If not active get out now! &
      doneif (field[abilActive].value = 0)

      ~ Change dice to d6
      #value2[rcPUaRngAt] = 6

      ~ Set the "Active Energy Type" on to the ranged attack pick
      perform hero.pulltags[PsiActEne.?]
      perform hero.childfound[rcPUaRngAt].pushtags[PsiActEne.?]]]>
      <before name="Aegis Ranged Attack"/>
      </eval>
    <exprreq message="Ranged Attack customization required."><![CDATA[#hasability[rcPUaRngAt] <> 0]]></exprreq>
    <prereq message="Aegis level 4+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 4)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaEmBl" name="Empowered Blast" description="The aegis can spend power points to increase the damage of his energy blast attack. Once per round, before making an attack using the energy blast customization, the aegis can spend up to his class level in power points as a free action, to gain +1d6 damage for every 1 power point spent. An attack that misses is wasted. The aegis must be at least 4th level and have the energy blast and ranged attack customizations before selecting this customization." compset="CustomSpec" uniqueness="useronce">
    <fieldval field="actName" value="Power Points"/>
    <fieldval field="actUserMin" value="1"/>
    <fieldval field="actUserMax" value="20"/>
    <fieldval field="abValue2" value="6"/>
    <usesource source="pPsiUn"/>
    <tag group="User" tag="Activation"/>
    <tag group="Helper" tag="UserAdjust"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final"><![CDATA[
      ~If not active get out now! &
      doneif (field[abilActive].value = 0)

      ~ Set the energy type on the ranged attack pick
      #extradamage[hero.childfound[rcPUaRngAt],signed(field[actUser].value) & "d" & field[abValue2].value,field[name].text]]]>
      <before name="Aegis Ranged Attack"/>
      </eval>
    <exprreq message="Energy Blast customization required."><![CDATA[#hasability[rcPUaEneBl] <> 0]]></exprreq>
    <exprreq message="Ranged Attack customization required."><![CDATA[#hasability[rcPUaRngAt] <> 0]]></exprreq>
    <prereq message="Power Points spent can not be over your class level.">
      <validate><![CDATA[
        ~ Only do this test if we are a pick
        validif (@ispick = 0)

        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= altpick.field[actUser].value)]]></validate>
      </prereq>
    <prereq message="Aegis level 4+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 4)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaEnerR" name="Energy Resistance" description="The aegis gains resist 5 against his active energy type. This resistance increases by 5 for every 5 levels the aegis possesses, to a maximum of 15 at 10th level. This customization can be selected multiple times. Each time beyond the first, the aegis selects an energy type (cold, electricity, fire, or sonic) to gain resistance to, in addition to his active energy type. If the aegis&apos;s active energy type is the same as one he has selected, the effects do not stack." compset="CustomSpec" uniqueness="useronce">
    <fieldval field="abValue" value="5"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="Helper" tag="SpecUp"/>
    <eval phase="PostLevel" priority="20000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Calculate the Resistance bonus
      field[abValue].value += round(linkage[table].field[cfgLevel].value/5,0,-1) * 5

      ~ Make sure oure maximum value is 15
      field[abValue].value = minimum(field[abValue].value, 15)

      ~ If value two is not zero then double by that amount
      If (field[abValue2].value <> 0) Then
        field[abValue].value *= field[abValue2].value
      Endif

      ~ Based on the Active Energy Type give energy resistance
      if (hero.tagis[PsiActEne.Cold] <> 0) then
        #applyresist[xDamRsCold, field[abValue].value]
      elseif (hero.tagis[PsiActEne.Elec] <> 0) then
        #applyresist[xDamRsElec, field[abValue].value]
      elseif (hero.tagis[PsiActEne.Fire] <> 0) then
        #applyresist[xDamRsFire, field[abValue].value]
      elseif (hero.tagis[PsiActEne.Sonic] <> 0) then
        #applyresist[xDamRsSoni, field[abValue].value]
      endif]]>
      <after name="Astral Suit Configurable"/>
      </eval>
    </thing>
  <thing id="cPUaEnerRe" name="Energy Resistance, Extra" description="The aegis gains resist 5 against his active energy type. This resistance increases by 5 for every 5 levels the aegis possesses, to a maximum of 15 at 10th level. This customization can be selected multiple times. Each time beyond the first, the aegis selects an energy type (cold, electricity, fire, or sonic) to gain resistance to, in addition to his active energy type. If the aegis&apos;s active energy type is the same as one he has selected, the effects do not stack." compset="CustomSpec" summary="Gain an additional energy type.">
    <fieldval field="usrCandid1" value="component.SelectHelp &amp; Psionics.PsiActEne"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="25000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Set amount of resistance
      field[abValue].value += #value[rcPUaEnerR]

      ~ If nothing's been selected, there's nothing we can do
      doneif (field[usrChosen1].ischosen = 0)

      ~ Set resistance amount
      #applybonus[abValue, field[usrChosen1].chosen, field[abValue].value]]]></eval>
    <exprreq message="Energy Resistance customization required."><![CDATA[#hasability[rcPUaEnerR] <> 0]]></exprreq>
    </thing>
  <thing id="rcPUaIEneR" name="Energy Resistance, Improved" description="The energy resistance gained from the Energy Resistance customization doubles. The aegis must have the Energy Resistance customization and be at least 6th level to select this customization." compset="CustomSpec" summary="2x your energy ristance." uniqueness="useronce">
    <fieldval field="abValue" value="2"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set the energy resistance amount to be doubled &
      #applybonus[abValue2, hero.childfound[rcPUaEnerR], field[abValue].value]]]></eval>
    <exprreq message="Energy Resistance customization required."><![CDATA[#hasability[rcPUaEnerR] <> 0]]></exprreq>
    <prereq message="Aegis level 6+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 6)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaEnerI" name="Energy Immunity" description="The aegis gains immunity to his active energy type as long as he is wearing his astral suit.{br}{br}The aegis must be at least 15th level before selecting this customization." compset="CustomSpec" summary="Gain immunity to your active energy type." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="4"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="xImmCold">
      <containerreq phase="First" priority="4500"><![CDATA[PsiActEne.Cold & Custom.WearAstS]]></containerreq>
      </bootstrap>
    <bootstrap thing="xImmElec">
      <containerreq phase="First" priority="4500"><![CDATA[PsiActEne.Elec & Custom.WearAstS]]></containerreq>
      </bootstrap>
    <bootstrap thing="xImmFire">
      <containerreq phase="First" priority="4500"><![CDATA[PsiActEne.Fire & Custom.WearAstS]]></containerreq>
      </bootstrap>
    <bootstrap thing="xImmSoni">
      <containerreq phase="First" priority="4500"><![CDATA[PsiActEne.Sonic & Custom.WearAstS]]></containerreq>
      </bootstrap>
    <prereq message="Aegis level 15+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 15)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaExArL" name="Extra Arms, Lesser" description="The aegis&apos;s astral suit has an extra pair of arms with limited function. Each arm can hold, but not use, any one item that can normally be held in one hand. Items held in this way count toward the aegis&apos;s carrying capacity. The aegis can retrieve any item held by his extra arms as a swift action. The aegis does not gain any mechanical benefit from items held by these arms, such as a shield bonus to armor class." compset="CustomSpec" summary="Gain an extra pair of arms that can hold items." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="First" priority="200"><![CDATA[
      ~ If two hands not in use then add two tags to hero
      ~ and get out! &
      If (field[abilAct2].value = 1) Then
        perform hero.pushtags[Activated.?]
        perform hero.pushtags[Activated.?]

      ~ Only one hand free so push only one tag
      ElseIf (field[abilActive].value = 1) Then
        perform hero.pushtags[Activated.?]
      Endif]]></eval>
    <eval phase="PreLevel" priority="5000" index="2"><![CDATA[
      ~ If we don't have Lesser or Greater arms do not show activation
      ~ options because they don't yet do anything.
      doneif (hero.tagis[Ability.rcPUaExtAr] + hero.tagis[Ability.rcPUaExArG] = 0)
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Show choice of free hands
      perform assign[User.Activation]
      field[actName].text = "1 hand free"
      field[actName2].text = "2 hands free"]]></eval>
    <eval phase="PreLevel" priority="10000" index="3"><![CDATA[
      ~ If two hands not in use get out now! &
      doneif (field[abilAct2].value = 0)

      ~ If both hands in use prevent 1 hand in use from
      ~ being activated.
      perform assign[Helper.ChgDisab1]]]></eval>
    </thing>
  <thing id="rcPUaExtAr" name="Extra Arms" description="The extra arms on the aegis&apos;s astral suit gain improved functionality. The aegis gains a +2 circumstance bonus to Climb checks and CMD against grapple attempts for each extra arm that is not holding anything. In addition, one of the arms can wield and use a light or one-handed weapon, a shield, or any other item that can be used with one hand. Attacks made with this additional arm suffer a -2 penalty to attack rolls in addition to any penalties for using two weapons.{br}{br}These extra arms do not grant any additional attacks, only alternate arms with which to make the standard attacks. The aegis must be at least 5th level and have the Lesser Extra Arms customization before selecting this customization." compset="CustomSpec" summary="Bonus to Climb and CMD or -2H with weapons." uniqueness="useronce">
    <fieldval field="abValue2" value="2"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <eval phase="PreLevel" priority="10000"><![CDATA[
      ~ If no hands free to use then get out now! &
      doneif (hero.tagis[Activated.rcPUaExArL] = 0)
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Calcaulte bonus to arms
      field[abValue].value += hero.tagcount[Activated.rcPUaExArL] * field[abValue2].value

      ~ Give bonus to Climb and Grapple CMD
      #skillbonus[skClimb] += field[abValue].value
      hero.child[manGrapple].field[cmdBonus].value += field[abValue].value]]></eval>
    <exprreq message="Extra Arms, Lesser customization required."><![CDATA[#hasability[rcPUaExArL] <> 0]]></exprreq>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaExArG" name="Extra Arms, Greater" description="The extra arms on the aegis&apos;s astral suit function at nearly the same capacity as his normal arms. Each arm can now wield or use a light or one-handed weapon, shield, or any other item that he could normally use. Alternatively, the aegis can use one or both arms when wielding a two-handed weapon, possibly allowing him to wield a pair of two-handed weapons. The circumstance bonus on Climb checks and CMD against grapple attempts increases to +3 per extra arm that is not holding anything. The aegis must be 8th level and have the Extra Arms and Lesser Extra Arms customizations before selecting this customization." compset="CustomSpec" summary="Extra arms now work like your normal arms." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="First" priority="300"><![CDATA[
      ~ Increase bonus to +3 per arm &
      #value2[rcPUaExtAr] += 1

      ~ If no hands free to use then get out now! &
      doneif (hero.tagis[Activated.rcPUaExArL] = 0)
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Give extra hands free
      herofield[tNumHands].value += hero.tagcount[Activated.rcPUaExArL]]]></eval>
    <exprreq message="Extra Arms, Lesser customization required."><![CDATA[#hasability[rcPUaExArL] <> 0]]></exprreq>
    <exprreq message="Extra Arms customization required."><![CDATA[#hasability[rcPUaExtAr] <> 0]]></exprreq>
    <prereq message="Aegis level 8+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 8)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaHardS" name="Hardened Strikes" description="The aegis is considered to be armed even when unarmed, does not provoke attacks of opportunity when making unarmed strikes, and his unarmed strikes deal lethal damage. In addition, the aegis&apos;s unarmed strikes can deal slashing or piercing damage, chosen at the time the customization is selected, instead of bludgeoning damage." compset="CustomSpec" summary="Unarmed strikes deal lethal damage &amp; an additional damage type." uniqueness="useronce">
    <fieldval field="usrCandid1" value="component.SelectHelp &amp; PackSelect.DamageType &amp; (wType.S | wType.P)"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="First" priority="1000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)
      ~ If nothing chosen get out now!
      doneif (field[usrChosen1].ischosen = 0)

      ~ Get the chosen weapon damage type
      perform field[usrChosen1].chosen.pulltags[wType.?]

      ~ find all unarmed strikes
      foreach pick in hero from BaseWep where "IsWeapon.wUnarmed"
        ~ Add damage type
        perform eachpick.pushtags[wType.?]
        ~ Make lethal damage
        perform eachpick.delete[wSpecial.Nonlethal]
      nexteach]]></eval>
    </thing>
  <thing id="rcPUaPwrSR" name="Power Stone Repository" description="The aegis may absorb power stones into his astral suit, causing them to appear and disappear whenever the suit does. The aegis may choose to have the absorbed power stones visible (much like embedded gems), or may decide to keep any or all of them concealed. The aegis may store one power stone per class level in this fashion; adding or removing a power stone takes 1 minute per stone (any power stone that is completely flushed and powerless dissolves immediately and is not counted against the aegis&apos;s limit).{br}{br}The aegis may activate any power stone stored in his repository as if he were holding it in hand; this follows all of the standard rules for using power stones, except the aegis gets a bonus equal to the number of stored power stones to any Use Magic Device checks he makes for this purpose. If the aegis loses this customization for any reason, any power stones stored in the astral suit are inert but unharmed until removed or this customization is regained.\n\n{B}Note:{/b} After adding this ability you will get a new Power Stone selection on the Astral Suit tab that will let you add powers." compset="CustomSpec" summary="Absorb power stones into your astral suit." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="First" priority="1000"><![CDATA[
      ~ Allow powers to a be added/tracked on the Astral Suit
      hero.childfound[cfgPUAstSu].field[cfgPower1].text = "Power Stone(s)"]]></eval>
    <eval phase="PostLevel" priority="10000" index="2"><![CDATA[
      ~ find all Astral Suit powers and turn them into a 1/use ability
      foreach pick in hero from BasePower where "CfgPower.cfgPUAstSu"
        perform eachpick.assign[Helper.PsiLike]
        perform eachpick.assign[Usage.Use]
        eachpick.field[trkMax].value += 1
        field[abValue5].value += 1
      nexteach]]></eval>
    <prereq message="Too many power stones added.">
      <validate><![CDATA[
        ~ Only do this validation when we are pick
        validif (@ispick = 0)

        validif (altpick.field[abValue5].value <= altpick.linkage[table].field[cfgLevel].value)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaHarPS" name="Harness Power Stone" description="The aegis can manifest a single 1st-level power from a power stone stored in his power stone repository as if it were a known power, with an effective manifester level of 1. This effective manifester level does not make an aegis eligible for feats and prestige classes requiring a manifester level, nor does it allow him to activate other power stones without a Use Magic Device check. The aegis may manifest the chosen power as many times as his power point pool will allow, but changing to a different power (either within the same power stone, or within another power stone in the repository) requires a move action and flushes the old power from the power stone (so power stones with multiple powers lose one power, but the rest are unaffected; power stones with only a single power are flushed and dissolved). If this customization is lost or removed, any applicable attuned power is flushed from the power stone. The aegis must be at least 3rd level and have the Power Stone Repository customization to select this customization. This customization may be selected a second time beginning at 5th level; doing so allows the aegis to manifest a second 1st-level power from a power stone (either a second stone, or a second power in an already-selected stone). The aegis may freely alternate between these two powers (or any others gained via Harness Power Stone customizations) when manifesting, but trading out either power for a new power flushes out the sacrificed power as usual.\n\n{B}Note:{/b} Not Fully Implemented.(TODO)" compset="CustomSpec">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <exprreq message="Power Stone Repository customization required."><![CDATA[#hasability[rcPUaPwrSR] <> 0]]></exprreq>
    <prereq message="Aegis level 3+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 3)]]></validate>
      </prereq>
    <prereq message="">
      <validate><![CDATA[
        var allowed as number
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs

        allowed = 1
        ~ 2nd copy allowed at level 5
        If (levels >= 5 ) then
          allowed += 1
        Endif

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaHarPS] <= allowed)

        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaHarPS] < allowed)
        endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaHaPSI" name="Harness Power Stone, Improved" description="The aegis is able to manifest a single 2nd level or lower power from a power stone in his repository as if it were a known power. The aegis&apos;s effective manifester level when manifesting powers from power stones in this fashion is increased by 3 (this stacks with the effective manifester level gained from Harness Power stone as well as any effective manifester level increases granted by any of the other Harness Power Stone customizations). If this customization is lost or removed, any applicable attuned power is flushed from the power stone. The aegis does not need to have taken any previous Harness Power Stone customizations to take this customization. The aegis must be at least 7th level and have the Power Stone Repository customization to take this customization. The aegis can take this customization a second time at 9th level; doing so does not increase his effective manifester level, but allows him to manifest a second 2nd level power from a power stone.\n\n{B}Note:{/b} Not Fully Implemented.(TODO)" compset="CustomSpec">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="2"/>
    <exprreq message="Power Stone Repository customization required."><![CDATA[#hasability[rcPUaPwrSR] <> 0]]></exprreq>
    <prereq message="Aegis level 7+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 7)]]></validate>
      </prereq>
    <prereq message="">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs

        var allowed as number
        if (levels <= 8 ) then
          allowed = 1
        else
          allowed = 2
        endif

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaHaPSI] <= allowed)
        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaHaPSI] < allowed)
        endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaHaPSG" name="Harness Power Stone, Greater" description="As Improved Harness Power Stone, except the power is 3rd level or lower, and the effective manifester level increase is +5. The aegis must be at least 11th level and have the Power Stone Repository customization to take this customization, and be 13th level to take this customization a second time.\n\n{B}Note:{/b} Not Fully Implemented.(TODO)" compset="CustomSpec">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="3"/>
    <exprreq message="Power Stone Repository customization required."><![CDATA[#hasability[rcPUaPwrSR] <> 0]]></exprreq>
    <prereq message="Aegis level 11+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 11)]]></validate>
      </prereq>
    <prereq message="">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        var allowed as number
        if (levels <= 12 ) then
          allowed = 1
        else
          allowed = 2
        endif

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaHaPSG] <= allowed)
        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaHaPSG] < allowed)
        endif

         @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaHaPSS" name="Harness Power Stone, Superior" description="As Improved Harness Power Stone, except the power is 4th level or lower, and the effective manifester level increase is +7. The aegis must be at least 16th level and have the Power Stone Repository customization to take this customization, and be 18th level to take this customization a second time.\n\n{B}Note:{/b} Not Fully Implemented.(TODO)" compset="CustomSpec">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="4"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <exprreq message="Power Stone Repositor customization required."><![CDATA[#hasability[rcPUaPwrSR] <> 0]]></exprreq>
    <prereq message="Aegis level 16+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 16)]]></validate>
      </prereq>
    <prereq message="">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs

        var allowed as number
        if (levels <= 17 ) then
          allowed = 1
        else
          allowed = 2
        endif

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaHaPSS] <= allowed)
        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaHaPSS] < allowed)
        endif
        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaHarSh" name="Harness Shard" description="The aegis is able to place a single {i}shard{/i} into the astral suit as a move action. By spending one power point as a standard action, he can gain one use of the {i}shard{/i} without the shard disintegrating. This customization may be selected multiple times. Each time, it allows the aegis to store an additional shard within the astral suit, although each shard must be activated separately.\n\n{B}Note:{/b} Not Fully Implemented.(TODO)" compset="CustomSpec">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="User" tag="Activation"/>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="rcPUaImpAr" name="Improved Armor" description="The astral suit thickens and strengthens, increasing the aegis&apos;s Armor bonus by +1. This customization can be taken once for every five levels the aegis possesses and stacks with any Armor bonus granted from the astral suit itself. The aegis must be at least 5th level before selecting this customization." compset="CustomSpec" summary="Astral Suit AC bonus increases by 1.">
    <comment>This ability is fully implemented. The procedure PUAstBonus handles the bonus logic.</comment>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <prereq message="">
      <validate><![CDATA[
        var allowed as number
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs

        ~ Additional copy allowed every 5 levels
        allowed += round(levels/5,0,-1)

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaImpAr] <= allowed)

        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaImpAr] < allowed)
        endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaPsiAt" name="Psionic Attacks" description="The aegis&apos;s astral suit encompasses his melee attacks. All of the aegis&apos;s melee attacks are treated as if they were magic for the purpose of overcoming damage reduction. In addition, any melee weapons wielded by the aegis are treated as masterwork if they are not already." compset="CustomSpec" summary="Melee weapons are treated as magic and MW." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="20000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ find all non-masterwork melee weapons
      foreach pick in hero from BaseWep where "!EquipType.Masterwork & wCategory.Melee"
        ~ Make all non-MW weapons into masterwork weapons
        perform eachpick.assign[EquipType.Masterwork]
      nexteach]]></eval>
    </thing>
  <thing id="rcPUaPsiDa" name="Psionic Damage" description="The aegis&apos;s melee attacks deal an additional 1 point of damage. The aegis must have the psionic attacks customization and must be at least 5th level to select this customization." compset="CustomSpec" summary="Melee weapons deal +1 damage." uniqueness="useronce">
    <fieldval field="abValue" value="1"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not enabled, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Increase the damage of melee weapons by 1
      hero.child[Damage].field[dmmBonus].value += field[abValue].value]]></eval>
    <exprreq message="Psionic Attacks customization required."><![CDATA[#hasability[rcPUaPsiAt] <> 0]]></exprreq>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaPull" name="Pull" description="The aegis&apos;s astral suit envelopes his weapon and grants him the ability to pull creatures closer with a successful melee attack. Whenever the aegis makes a successful melee attack, he can attempt a free combat maneuver check. If successful, the target of the attack is pulled 5 feet closer to the aegis. This ability only works on creatures of a size equal to or smaller than the aegis.{br}{br}Creatures pulled in this way do not provoke attacks of opportunity. The aegis must have a reach of 10 feet or more to select this customization. If there is insufficient room for the target to move closer to the aegis, the attempt automatically fails." compset="CustomSpec" summary="Successful melee attacks allow a CMB check to pull the target." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <exprreq message="10+ foot reach required."><![CDATA[herofield[tReach].value >= 10]]></exprreq>
    </thing>
  <thing id="rcPUaPush" name="Push" description="The aegis gains the ability to push creatures away with a successful attack. Whenever the aegis makes a successful melee attack, he can attempt a free combat maneuver check. If successful, the target of the attack is pushed 5 feet directly away from the aegis.{br}{br}This ability only works on creatures of a size equal to or smaller than the aegis. Creatures pushed in this way do not provoke attacks of opportunity. If there is insufficient room for the target to be pushed away, the attempt automatically fails." compset="CustomSpec" summary="Successful melee attacks allow a CMB check to push the target." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="rcPUaRetal" name="Retaliate" description="The aegis gains the ability as an immediate action and by expending psionic focus to make a melee attack against an enemy that has successfully hit him with a melee attack. This counts as an attack of opportunity and the aegis must be able to reach the enemy. An aegis must be at least 8th level before selecting this customization." compset="CustomSpec" summary="Immediate action expend focus to make an AoO vs attacker." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="abAction" tag="PUExpFocus"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <prereq message="Aegis level 8+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 8)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaIReta" name="Retaliate, Improved" description="As the Retaliate customization, except the triggering attack does not need to be successful.{br}{br}The aegis must have the Retaliate customization and be at least 16th level before selecting this customization." compset="CustomSpec" summary="The triggering attack does not need to be successful." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <exprreq message="Retaliate customization required."><![CDATA[#hasability[rcPUaRetal] <> 0]]></exprreq>
    <prereq message="Aegis level 16+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 16)]]></validate>
      </prereq>
    </thing>
  <thing id="wPUSpiCar" name="Carapace Spikes" description="The astral suit is covered in sharp spikes as if equipped with armor spikes." compset="Weapon" uniqueness="unique">
    <usesource source="pPsiUn"/>
    <tag group="wMain" tag="1d6"/>
    <tag group="wCritMin" tag="20"/>
    <tag group="wCritMult" tag="2"/>
    <tag group="wType" tag="P"/>
    <tag group="wClass" tag="OneHanded"/>
    <tag group="Helper" tag="Helper"/>
    <tag group="Helper" tag="NoOutGear"/>
    <tag group="wProfReq" tag="Martial"/>
    <tag group="wFtrGroup" tag="Close"/>
    <tag group="wCategory" tag="Melee"/>
    <tag group="Helper" tag="GearNoSize"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="50000"><![CDATA[
      ~ If no special material present then get out now! &
      doneif (tagcount[IsMaterial.?] =  0)

      ~ Append special material type onto name
      field[livename].text = tagnames[IsMaterial.?] & " " & field[thingname].text]]></eval>
    </thing>
  <thing id="rcPUaSpikC" name="Spiked Carapace" description="The astral suit is covered in sharp spikes as if equipped with armor spikes." compset="CustomSpec" summary="Gain armor spikes" uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="wPUSpiCar">
      <autotag group="HasAbility" tag="rcPUaSpikC"/>
      </bootstrap>
    </thing>
  <thing id="rcPUaSwim" name="Swim" description="The aegis gains a swim speed equal to his base speed." compset="CustomSpec" summary="Swim speed = base land speed." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="14000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Base speed
      field[abValue].value += hero.findchild[BaseRace].field[rSpeed].value

      #applybonus[abValue, hero.child[xSwim], field[abValue].value]]]></eval>
    </thing>
  <thing id="rcPUaUndw" name="Underwater Breath" description="The aegis can safely breathe underwater as long as he is wearing his astral suit." compset="CustomSpec" summary="You can breathe water as well as air." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="rcPUaAdFt1" name="Adhesive Feet" description="The aegis gains a +4 bonus to CMD against bull rush, trip, and any combat maneuvers that attempt to move him from his current location. He also gains a +4 circumstance bonus to Climb checks." compset="CustomSpec" summary="Bonus CMD vs being moved." uniqueness="useronce">
    <fieldval field="abValue" value="4"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PreLevel" priority="1000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ +4 circumstance to climb
      #applybonus[ModCirc,hero.childfound[skClimb],field[abValue].value]

      ~ +4 bonus to Bull Rush
      hero.child[manBullRus].field[manCMD].value += field[abValue].value

      #situational[hero.child[ManeuvDef],signed(field[abValue].value) & " bonus to CMD vs any combat maneuvers that attempt to move you from your current location.",field[thingname].text]]]></eval>
    </thing>
  <thing id="rcPUaAugWp" name="Augmented Weapon" description="The astral suit coats the aegis&apos;s weapon. The weapon is treated as if it was one size category larger for damage purposes. The aegis does not suffer any penalties for wielding the weapon. This ability does not stack with effects that increase the aegis&apos;s size category, such as {i}expansion{/i}. The aegis must be at least 6th level to select this customization.\n\n{b}Note:{/b} You must equip a weapon to see the damage increase." compset="CustomSpec" summary="Weapons treated as one size larger." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PreLevel" priority="5000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      foreach pick in hero from BaseWep where "fieldval:gIsEquip = 1"
        perform eachpick.assign[Helper.DamageUp]
      nexteach]]></eval>
    <prereq message="Aegis level 6+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 6)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaCham" name="Chameleon" description="The aegis gains a +4 circumstance bonus to Stealth checks. The aegis must be at least 5th level before selecting this customization and this customization can be taken once for every five levels the aegis possesses." compset="CustomSpec" summary="+4 bonus to stealth.">
    <fieldval field="abValue" value="4"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PreLevel" priority="1000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ +4 circumstance to climb
      #applybonus[ModCirc,hero.childfound[skStealth],field[abValue].value]]]></eval>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    <prereq message="">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        var allowed as number
        allowed = round(levels/5,0,-1)

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaCham] <= allowed)
        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaCham] < allowed)
        endif

         @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaClimb" name="Climb" description="The aegis gains a climb speed equal to 1/2 of his base land speed." compset="CustomSpec" summary="Climb speed = 1/2 base speed." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="14000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Half base speed
      field[abValue].value += round(hero.findchild[BaseRace].field[rSpeed].value/2,0,-1)

      #applybonus[abValue,hero.child[xClimb],field[abValue].value]]]></eval>
    </thing>
  <thing id="rcPUaCryWp" name="Crystallized Weapon" description="The aegis&apos;s astral suit envelopes his melee weapon. The weapon is treated as if made from deep crystal. This treats the weapon as a masterwork weapon if it was not already and the aegis can pay two power points to charge the weapon with psionic energy which deals 2d6 additional points of damage on its next hit. The weapon stays charged for 1 minute or until it successfully hits, whichever comes first.\n\n{b}Note:{/b} You must equip a weapon to see the MW value and the +2d6 damage." compset="CustomSpec" summary="melee weapons treated as deep crystal." uniqueness="useronce">
    <fieldval field="actName" value="2PP for +2d6"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="User" tag="Activation"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PreLevel" priority="5000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      foreach pick in hero from BaseWep where "fieldval:gIsEquip = 1 & wCategory.Melee"
        ~ Make it appear the equipped weapon is made of Deep Crystal material
        ~ and force it to be masterwork.
        perform eachpick.assign[IsMaterial.mCrysDeep]
        perform eachpick.assign[Ability.mCrysDeep]
        perform eachpick.assign[HasAbility.mCrysDeep]
        perform eachpick.assign[DescInfo.mCrysDeep]
        perform eachpick.assign[EquipType.Masterwork]

        ~ If ability is active then apply +2d6 damage
        If (field[abilActive].value = 1) Then
           #extradamage[eachpick,"+2d6",field[thingname].text]
        Endif
      nexteach]]></eval>
    </thing>
  <thing id="rcPUaFligh" name="Flight" description="The aegis uses psychokinetic energy to gain a fly speed equal to its base speed. The aegis&apos;s maneuverability depends on his size. Medium or smaller aegii have good maneuverability. Large aegii have average maneuverability, while Huge aegii have poor maneuverability. For 2 additional customization points, the aegis&apos;s maneuverability increases to perfect. The aegis&apos;s fly speed can be increased by spending additional customization points, gaining a 20-foot increase to fly speed for each additional point spent. The aegis must be at least 5th level before selecting this customization." compset="CustomSpec" summary="Fly speed = land speed.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="14000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Set fly speed equal to base land speed
      field[abValue].value += hero.findchild[BaseRace].field[rSpeed].value

      ~ Apply fly speed
      #applybonus[abValue,hero.child[xFly],field[abValue].value]

      ~ Set manueverability based on character size
      if (hero.tagis[Size.Medium] <> 0) then
         perform hero.child[xFly].assign[Maneuver.Good]
      elseif (hero.tagis[Size.Large] <> 0) then
         perform hero.child[xFly].assign[Maneuver.Average]
      elseif (hero.tagis[Size.Huge] <> 0) then
         perform hero.child[xFly].assign[Maneuver.Poor]
      endif]]></eval>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaFSpd" name="Flight Speed (+20)" description="The aegis&apos;s fly speed provided by the Flight customization can be increased by spending additional customization points, gaining a 20-foot increase to fly speed for each additional point spent. The aegis must be at least 5th level and have the Flight customization before selecting this customization." compset="CustomSpec" summary="Your fly speed increases by +20ft.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="10000"><![CDATA[
      ~ Increase the flight ability by 20ft &
      #value[rcPUaFligh] += 20]]></eval>
    <exprreq message="Flight customization required."><![CDATA[#hasability[rcPUaFligh] <> 0]]></exprreq>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaFMan" name="Flight Maneuverability (Perfect)" description="The aegis&apos;s fly maneuverability provided by the Flight customization can be increased to Perfect for 2 additional customization points. The aegis must be at least 5th level and have the Flight customization before selecting this customization." compset="CustomSpec" summary="You have perfect fly maneuverability." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="14100"><![CDATA[
      ~ If we're not wearling the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      perform hero.child[xFly].assign[Maneuver.Perfect]]]></eval>
    <exprreq message="Flight customization required."><![CDATA[#hasability[rcPUaFligh] <> 0]]></exprreq>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaIDamR" name="Improved Damage Reduction" description="The aegis&apos;s damage reduction from his astral suit increases by 1. This customization can be taken once for every five levels the aegis possesses Its effects stack. The aegis must be at least 5th level before selecting this customization." compset="CustomSpec">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="1000"><![CDATA[
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      #value[cPUAegDR] += 1]]></eval>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    <prereq message="">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs

        var allowed as number
        allowed = round(levels/5,0,-1)

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaIDamR] <= allowed)
        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaIDamR] < allowed)
        endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaInSiz" name="Increased Size" description="The transformed body grows in size and the aegis and all of his equipment is treated as one size category larger as if affected by {i}expansion{/i}. The aegis must be at least 9th level to select this customization." compset="CustomSpec" summary="Grow one size larger." uniqueness="useronce">
    <fieldval field="abValue" value="1"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="DescInfo" tag="puExpand1"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="First" priority="1000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      #applybonus[aSizeBon,hero.child[aSTR],2]
      hero.child[aDEX].field[aSizePen].value -= 2

      ~ we want to increase our size by +1
      var sizemod as number
      sizemod = field[abValue].value

      call SizeChange]]></eval>
    <prereq message="Aegis level 9+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 9)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaIISiz" name="Increased Size, Improved" description="The astral suit grows in size and the aegis is treated as two size categories larger as if affected by an augmented {i}expansion{/i}. The aegis must be at least 15th level and have selected the increased size customization to select this customization. This customization does not stack with the increased size customization." compset="CustomSpec" summary="Increased size increases size by two size categories." uniqueness="useronce">
    <fieldval field="abValue" value="1"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="4"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="First" priority="500"><![CDATA[
      ~ Increased Size now does 2 sizes instead of one &
      #value[rcPUaInSiz] += field[abValue].value]]></eval>
    <exprreq message="Increased Size customization required."><![CDATA[#hasability[rcPUaInSiz] <> 0]]></exprreq>
    <prereq message="Aegis level 15+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 15)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaPwrR" name="Power Resistance" description="The aegis gains power resistance 13. This customization may be selected up to 3 times. Each subsequent time increases the power resistance gained by 3. This ability can be selected again starting at 8th level and at 12th level, increasing the power resistance by 3 for every additional time it is taken." compset="CustomSpec" summary="Gain Power Resistance.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="5000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Calc PR as 10 + (3 x the number of times taken)
      field[abValue].value += 10 + (3 * hero.tagcount[Ability.rcPUaPwrR])

      ~ Apply PR value
      #applybonus[abValue,hero.childfound[xPwrRes],field[abValue].value]]]></eval>
    <prereq message="">
      <validate><![CDATA[
        var allowed as number
        if (#levelcount[Aegis] <= 7 ) then
          allowed = 1
        elseif (#levelcount[Aegis] <= 11) then
          allowed = 2
        else
          allowed = 3
        endif

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaPwrR] <= allowed)

        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaPwrR] < allowed)
        endif

         @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaPowBl" name="Powerful Build" description="The aegis gains the powerful build trait while wearing his astral suit. Whenever the aegis is subject to a size modifier or special size modifier for a Combat Maneuver Bonus or Combat Maneuver Defense (such as during grapple checks, bull rush attempts, and trip attempts), the aegis is treated as one size larger if doing so is advantageous to him. The aegis is also considered to be one size larger when determining whether a creature&apos;s special attacks based on size (such as grab or swallow whole) can affect him. The aegis can use weapons designed for a creature one size larger without penalty. However, his space and reach remain those of a creature of his actual size. The benefits of this trait stack with the effects of powers, abilities, and spells that change the subject&apos;s size category." compset="CustomSpec" summary="Treated as one size larger." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="xPowBuild">
      <containerreq phase="First" priority="500"><![CDATA[count:hero#Custom.WearAstS <> 0]]></containerreq>
      </bootstrap>
    </thing>
  <thing id="rcPUaRam" name="Ram" description="The astral suit forms a hardened shell over the aegis&apos;s head. If the aegis makes a bull rush or overrun attempt, he gains a +2 bonus to his CMB. Alternatively, he can make a single attack with this shell as part of a charge and deal 2d6 points of damage. This attack is treated as adamantine when used to attack an object.{br}{br}This customization can be taken once for every five levels the aegis possesses, each additional selection increasing the bonus to CMB by 1 and the damage on a charge by 1d6 points of damage. The aegis must be at least 5th level before selecting this customization." compset="CustomSpec" summary="On a charge deal damage.">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set Helper.FirstCopy &
      call X1SetFirst]]></eval>
    <eval phase="PostLevel" priority="10050" index="2"><![CDATA[
      ~ Calc CMB bonus as 1 plus the number of times this ability was taken
      field[abValue].value += 1 + field[abValue5].value

      ~ If we are not the first copy, get out now!
      doneif (tagis[Helper.FirstCopy] = 0)

      ~ Set livename with damage
      field[livename].text = field[name].text & " " & signed(field[abValue].value) & "d6"

      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Give bonus to Bull Rush and Overrun
      hero.child[manBullRus].field[cmbBonus].value += field[abValue].value
      hero.child[manOverrun].field[cmbBonus].value += field[abValue].value]]></eval>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    <prereq message="">
      <validate><![CDATA[
        var allowed as number
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs

        ~ Additional copy allowed every 5 levels
        allowed += round(levels/5,0,-1)

        ~ if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        if (@ispick <> 0) then
          validif (tagcount[HasAbility.rcPUaRam] <= allowed)

        ~ otherwise, look for fewer, since we're adding this
        else
          validif (tagcount[HasAbility.rcPUaRam] < allowed)
        endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaIRngA" name="Improved Ranged Attack" description="The damage of the aegis&apos;s ranged attack ability increases by an additional 1d8 points of piercing damage for every five class levels the aegis has. If the aegis is using the energy blast customization, the additional damage is instead 1d6 points of damage of your active energy type for every five class levels. The aegis must be at least 5th level and have the ranged attack customization before selecting this customization." compset="CustomSpec" summary="Increase range dmg by +1d8." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="20000" index="2"><![CDATA[
      ~ Calculate the bonus number of dice &
      field[abValue].value += round(linkage[table].field[cfgLevel].value/5,0,-1)

      ~ Incresae the number of dice
      #value[rcPUaRngAt] += field[abValue].value]]></eval>
    <exprreq message="Ranged Attack custoization required."><![CDATA[#hasability[rcPUaRngAt] <> 0]]></exprreq>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaIEnBl" name="Improved Energy Blast" description="When using the energy blast customization, the attack can target up to three creatures, no two of which can be more than fifteen feet apart. Each creature may only be the target of one such attack each round. Each attack is rolled separately. The aegis must be at least 12th level and have the energy blast and ranged attack customizations before selecting this customization." compset="CustomSpec" summary="Attack 3 targets no 2 of which can not be more than 15ft apart." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <exprreq message="Energy Blast customization required."><![CDATA[#hasability[rcPUaEneBl] <> 0]]></exprreq>
    <exprreq message="Ranged Attack customization required."><![CDATA[#hasability[rcPUaRngAt] <> 0]]></exprreq>
    <prereq message="Aegis level 12+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 12)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaWoStr" name="Woodland Stride" description="While wearing his astral suit, the trailblazer may move through any sort of undergrowth (such as natural thorns, briars, overgrown areas, and similar terrain) at his normal speed and without taking damage or suffering any other impairment. Thorns, briars, and overgrown areas that are enchanted or magically manipulated to impede motion, however, still affect him. The trailblazer must be at least 10th level before selecting this customization." compset="CustomSpec" summary="Move through undergrowth at your normal speed.">
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="abCategory" tag="arPUTrailb"/>
    </thing>
  <thing id="rcPUaFaTer" name="Favored Terrain" description="The trailblazer may select a single type of terrain from the Favored Terrains table. While wearing his astral suit, the trailblazer gains a +2 bonus on initiative checks and Knowledge (geography), Perception, Stealth, and Survival skill checks when in this terrain. The trailblazer traveling through his favored terrain normally leaves no trail and cannot be tracked (though he may leave a trail if he so chooses).{br}{br}The trailblazer must be at least 5th level before selecting this customization." compset="CustomSpec">
    <fieldval field="abValue" value="2"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="arPUTrailb"/>
    <tag group="User" tag="NeedDomain"/>
    <tag group="User" tag="Activation"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="25000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)
      ~ If we're not active get out now!
      doneif (field[abilActive].value = 0)

      ~ Give bonus to init and skills
      hero.child[Initiative].field[Bonus].value += field[abValue].value
      #skillbonus[skKnowGeog] += field[abValue].value
      #skillbonus[skPercep] += field[abValue].value
      #skillbonus[skStealth] += field[abValue].value
      #skillbonus[skSurvival] += field[abValue].value]]></eval>
    <prereq message="Aegis level 5+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 5)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaTrem" name="Tremorsense" description="The aegis gains tremorsense out to a range of 30 feet. This allows the aegis to pinpoint the location of creatures that it cannot see without having to make a Perception check as long as the creature and the aegis are in contact with the ground, but such creatures still have total concealment from the aegis. Visibility still affects the aegis&apos;s movement and he is still denied his Dexterity bonus to Armor Class against attacks from creatures he cannot see. The aegis must be at least 7th level before selecting this customization." compset="CustomSpec" summary="Gain 30ft tremorsense." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="xTremorsen">
      <containerreq phase="First" priority="500"><![CDATA[count:hero#Custom.WearAstS <> 0]]></containerreq>
      <assignval field="abValue" value="30"/>
      </bootstrap>
    <prereq message="Aegis level 7+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 7)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaUnloc" name="Unlock Psionics" description="The astral suit is able to emit energy that resonates with psionic items, helping the aegis use them. The aegis gains a +2 bonus to Use Magic Device checks while wearing his astral suit. If the aegis has 10 ranks in Use Magic Device, this bonus increases to +4." compset="CustomSpec" summary="Bonus on Use Magic Device checks." uniqueness="useronce">
    <fieldval field="abValue" value="2"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="Helper" tag="SpecUp"/>
    <eval phase="PostLevel" priority="15000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ At 10 ranks increase bonus to +4
      If (#skillranks[skUseMagic] >= 10) then
        field[abValue].value += 2
      Endif

      #skillbonus[skUseMagic] += field[abValue].value]]></eval>
    </thing>
  <thing id="rcPUaBlind" name="Blindsense" description="The astral suit augments the aegis&apos;s senses, giving him blindsense out to a range of 30 feet.{br}{br}This ability allows the aegis to pinpoint the location of creatures that he cannot see without having to make a Perception check, but such creatures still have total concealment from the aegis. Visibility still affects the aegis&apos;s movement and he is still denied his Dexterity bonus to Armor Class against attacks from creatures he cannot see. The aegis must be at least 9th level before selecting this customization." compset="CustomSpec" summary="Gain 30ft blindsense." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="rBlindsen">
      <containerreq phase="First" priority="500"><![CDATA[count:hero#Custom.WearAstS <> 0]]></containerreq>
      <assignval field="abValue" value="30"/>
      </bootstrap>
    <prereq message="Aegis level 9+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 6)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaBurro" name="Burrow" description="The aegis gains a burrow speed equal to 1/2 his base speed. He can use this speed to move through dirt, clay, sand, and earth. He does not leave a hole behind, nor is his passage marked on the surface. The aegis must be at least 9th level before selecting this customization." compset="CustomSpec" summary="Gain a burrow speed equal to 1/2 your base speed." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="14000"><![CDATA[
      ~ If we're not wearling the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Half base speed
      field[abValue].value += round(hero.findchild[BaseRace].field[rSpeed].value/2,0,-1)

      #applybonus[abValue,hero.child[xBurrow],field[abValue].value]]]></eval>
    <prereq message="Aegis level 9+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 9)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaDieha" name="Diehard" description="When the aegis&apos;s hit point total is below 0, but he is not dead, he automatically stabilizes. He does not need to make a Constitution check each round to avoid losing additional hit points. He may choose to act as if disabled, rather than dying. He must make this decision as soon as he is reduced to negative hit points (even if it isn&apos;t his turn). If he does not choose to act as if disabled, he immediately falls unconscious. When under this effect, the aegis is staggered. He can take a move action without further injuring himself, but if he performs any standard action (or any other action deemed as strenuous, including some swift actions, such as manifesting a quickened power) he takes 1 point of damage after completing the act. If his negative hit points are equal to or greater than his Constitution score, he immediately dies." compset="CustomSpec" uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="rcPUaFrigh" name="Frightful Presence" description="The aegis makes his astral suit unsettling to his foes, gaining the frightful presence ability. The aegis can activate this ability as part of an offensive action, such as a charge or attack. Opponents within 30 feet of the aegis must make a Will save or become shaken for 3d6 rounds. The DC of this save is equal to 10 + 1/2 the aegis&apos;s class level + the aegis&apos;s Charisma modifier. If the aegis has at least 4 more Hit Dice than an opponent, that opponent becomes frightened instead. Foes with more HD than the aegis are immune to this effect. The aegis must be at least 11th level before selecting this customization." compset="CustomSpec" summary="Gain the frightful presence ability." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="StandardDC" tag="aCHA"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="20000">~ Calculate the DC = 1/2 aegis + Cha
      field[abDC].value += round(linkage[table].field[cfgLevel].value/2,0,-1)</eval>
    <prereq message="Aegis level 11+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 11)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaQuick" name="Quickened Attacks" description="When the aegis makes a full attack, he gains one additional attack at his highest attack bonus.{br}{br}This customization does not stack with other sources of extra attacks, such as {i}haste{/i}. The aegis must be at least 10th level before selecting this customization." compset="CustomSpec" summary="Gain an addiitional attack at your highest BAB." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="50000"><![CDATA[
      ~ If we're not wearling the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Give weapons an extra attack
      foreach pick in hero from BaseWep where "!Helper.NatAttSpec & !wGroup.Natural & !Helper.ExtraHigh"
         perform eachpick.assign[Helper.ExtraHigh]
      nexteach]]></eval>
    <prereq message="Aegis level 10+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 10)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaReach" name="Reach" description="The aegis&apos;s reach increases by 5 feet. The aegis must be at least 7th level before selecting this customization." compset="CustomSpec" summary="Reach increases by +5ft." uniqueness="useronce">
    <fieldval field="abValue" value="5"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Final" priority="15000"><![CDATA[
      ~ If we're not wearling the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      ~ Increase reach by 5ft
      herofield[tReach].value += field[abValue].value]]></eval>
    <prereq message="Aegis level 7+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 7)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaBlinS" name="Blindsight" description="The astral suit massively augments the aegis&apos;s senses, giving him blindsight out to a range of 30 feet. The aegis can maneuver and attack as normal, ignoring darkness, invisibility, and most forms of concealment as long as he has line of effect to the target.{br}{br}The aegis must possess the blindsense customization to take this customization. The aegis must be at least 11th level before selecting this customization." compset="CustomSpec" summary="Gain 30ft blindsight." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="4"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="rBlindSi">
      <containerreq phase="First" priority="500"><![CDATA[count:hero#Custom.WearAstS <> 0]]></containerreq>
      <assignval field="abValue" value="30"/>
      </bootstrap>
    <prereq message="Aegis level 11+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 11)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaExPas" name="Extra Passenger" description="The aegis can carry one creature of the same size or smaller as the aegis&apos;s base size (powers and effects that increase the aegis&apos;s size do not allow him to carry larger creatures, although Increased Size and Improved Increased Size customizations do allow the aegis to carry larger passengers). The carried creature is treated as if it has total concealment and he gains the damage reduction of the astral suit, as well as any environmental customization options, such as that granted from the Energy Resistance or Underwater Breath customization. The creature carried using this ability remains adjacent to the aegis and moves with the aegis&apos;s move actions. A creature can be loaded and unloaded into the astral suit as a free action by the aegis, but the creature can take no actions until its next turn.{br}{br}The aegis must be at least 11th level before selecting this customization." compset="CustomSpec" summary="Carry 1 creature of same size or smaller." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="CustomCost" tag="4"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <prereq message="Aegis level 11+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 11)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaIEvad" name="Improved Evasion" description="As long as the aegis is wearing the astral suit, if the aegis is subjected to an attack that normally allows a Reflex save for half damage, he takes no damage if he makes a successful saving throw and only half damage if the saving throw fails. The aegis must be at least 12th level before selecting this customization." compset="CustomSpec" summary="Gain improved evasion." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="4"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="raImpEvas">
      <containerreq phase="First" priority="500"><![CDATA[count:hero#Custom.WearAstS <> 0]]></containerreq>
      </bootstrap>
    <prereq message="Aegis level 12+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 12)]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaIStal" name="Improved Stalwart" description="As long as the aegis is wearing the astral suit, if the aegis is subjected to an attack that normally allows a Fortitude or Will save for a reduced or partial effect, he can expend his psionic focus as an immediate action to ignore the effect if he makes a successful saving throw and suffers the reduced effect if the saving throw fails. The aegis must be at least 16th level before selecting this customization." compset="CustomSpec" summary="Expend focus to ingore partial Will/Fort saves." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="PUAegisCus"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="CustomCost" tag="4"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <prereq message="Aegis level 16+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 16)]]></validate>
      </prereq>
    </thing>
  <thing id="arPUTrailb" name="Trailblazer" description="The trailblazer develops skills to aid him in tracking prey and avoiding obstacles, rather than in the learning how to manipulate and craft psionic items. He uses his astral suit to improve his ability to move and handle varied environments, in addition to its use as a form of protection. Where other hunters might find armor to be a hindrance, the trailblazer&apos;s astral suit is an asset, helping him to blend in with his surroundings.{br}{br}{b}Class Skills:{/b} A trailblazer adds Survival as a class skill, but does not count Use Magic Device as a class skill." compset="ClassVary" uniqueness="unique">
    <fieldval field="srcPageNum" value="264"/>
    <fieldval field="srcBookInf" value="Ultimate Psionics"/>
    <usesource source="pPsiUn"/>
    <tag group="ClVaryName" tag="AppParen"/>
    <tag group="abCategory" tag="arPUTrailb" name="Trailblazer Customization"/>
    <tag group="AbReplace" tag="cPUCraftsm"/>
    <tag group="AbReplace" tag="cPUReconfi"/>
    <tag group="AbReplace" tag="cPUAugSuit"/>
    <tag group="AbReplace" tag="cPUMastCr"/>
    <tag group="NotClassSk" tag="skUseMagic"/>
    <tag group="ClassSkill" tag="skSurvival"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="cPUAegTrk">
      <autotag group="ClSpecWhen" tag="2"/>
      </bootstrap>
    <bootstrap thing="cPURapAdj">
      <autotag group="ClSpecWhen" tag="3"/>
      </bootstrap>
    <bootstrap thing="cPUUndTra">
      <autotag group="ClSpecWhen" tag="4"/>
      </bootstrap>
    <bootstrap thing="cPUAegTrap">
      <autotag group="ClSpecWhen" tag="5"/>
      </bootstrap>
    <link linkage="varies" thing="cHelpPU0"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Setup Aegis Configurable &
      Call SetAegArch]]></eval>
    </thing>
  <thing id="cPUAegTrk" name="Track" description="A trailblazer adds half his level (minimum 1) to Survival skill checks made to follow tracks." compset="ClSpecial" summary="Add the listed bonus to survival checks made to track.">
    <comment>Trailblazer Archetype ability</comment>
    <tag group="AbilType" tag="Extra"/>
    <tag group="LvNameApp" tag="AppValue"/>
    <tag group="LvNameApp" tag="SignAppVal"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="aaTrack"></bootstrap>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Bonus is half-level, min 1
      field[abValue].value += maximum(round(field[xTotalLev].value / 2,0,-1),1)

      #situational[hero.child[skSurvival],signed(field[abValue].value) & " to track.",field[thingname].text]]]></eval>
    </thing>
  <thing id="cPURapAdj" name="Rapid Adjustment" description="The trailblazer can, as a swift action, alter his astral suit&apos;s customizations to better allow him to follow prey or respond to changing environments, but he is limited to the list of customizations below when doing so. The customization being lost and the customization being gained must both be in the list below. The customizations the trailblazer can select from are Burrow, Chameleon, Climb, Darkvision, Flight, Speed, Swim, Underwater Breath. This ability replace reconfigure." compset="ClSpecial">
    <comment>Trailblazer Archetype ability</comment>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="cPUUndTra" name="Undetected Tracker" description="Starting at 4th level, the trailblazer learns how to make his astral suit blend in with his environment and soften his movements. The trailblazer adds 1/2 his class level to Stealth checks as long as he is maintaining psionic focus and has his astral suit active. This ability replaces augment suit." compset="ClSpecial" summary="Add the listed bonus to Stealth checks  when focused and with an active astral suit.">
    <comment>Trailblazer Archetype ability</comment>
    <tag group="AbilType" tag="Extra"/>
    <tag group="LvNameApp" tag="AppValue"/>
    <tag group="LvNameApp" tag="SignAppVal"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Our bonus is level /2, min 1
      field[abValue].value += maximum(round(field[xTotalLev].value / 2,0,-1),1)

      var v_focus as number
      call PUPsiFocus
      ~ Only Apply bonus if focused and Wearing suit.
      doneif (hero.tagcount[Custom.WearAstS] + v_focus <> 2)

      #skillbonus[skStealth] += field[abValue].value]]></eval>
    </thing>
  <thing id="cPUAegTrap" name="Trapfinding" description="A trailblazer of 5th level adds 1/2 his class level to Perception skill checks made to locate traps and to Disable Device skill checks (minimum +1). A trailblazer can use Disable Device to disarm magic traps.{br}{br}This ability replaces Master Craftsman." compset="ClSpecial" summary="Gain a bonus to find or disable traps, including magical ones.">
    <comment>Trailblazer Archetype ability</comment>
    <tag group="LvNameApp" tag="AppValue"/>
    <tag group="LvNameApp" tag="SignAppVal"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="Render" priority="10000" index="2"><![CDATA[
      field[sbName].text = lowercase(field[thingname].text) & " " & signed(field[abValue].value)]]></eval>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] = 0)

      ~ If we're disabled, do nothing
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Only do it for the first copy.
      doneif (tagis[Helper.FirstCopy] = 0)

      ~ our bonus is level /2, min 1
      field[abValue].value += maximum(round(field[xAllLev].value / 2,0,-1),1)

      #skillbonus[skDisable] += field[abValue].value
      #situational[hero.child[skPercep],signed(field[abValue].value) & " to locate traps",field[thingname].text]]]></eval>
    </thing>
  <thing id="arPUAberra" name="Aberrant" description="Using ectoplasm is the way a typical aegis protects and enhances the physical body. Others have discovered that by directly altering the body, they can achieve similar results, although they might have a more grisly appearance. These aberrants often have misshapen or twisted forms, yet they are equally deadly." compset="ClassVary" uniqueness="unique">
    <fieldval field="srcPageNum" value="261"/>
    <fieldval field="srcBookInf" value="Ultimate Psionics"/>
    <usesource source="pPsiUn"/>
    <tag group="ClVaryName" tag="AppParen"/>
    <tag group="AbReplace" tag="cPUMastCr"/>
    <tag group="AbReplace" tag="cPUAstSuit"/>
    <tag group="AbReplace" tag="cPUAstrRep"/>
    <tag group="AbReplace" tag="cPUCraftsm"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="cPUVim">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="cPUTranBod">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="cPUIntim">
      <autotag group="ClSpecWhen" tag="2"/>
      </bootstrap>
    <bootstrap thing="cPUPsiForm">
      <autotag group="ClSpecWhen" tag="5"/>
      </bootstrap>
    <bootstrap thing="cPUTranBod">
      <autotag group="ClSpecWhen" tag="5"/>
      </bootstrap>
    <bootstrap thing="cPUTranBod">
      <autotag group="ClSpecWhen" tag="10"/>
      </bootstrap>
    <bootstrap thing="cPUTranBod">
      <autotag group="ClSpecWhen" tag="15"/>
      </bootstrap>
    <bootstrap thing="cPUTranBod">
      <autotag group="ClSpecWhen" tag="20"/>
      </bootstrap>
    <link linkage="varies" thing="cHelpPU0"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Setup Aegis Configurable &
      Call SetAegArch]]></eval>
    </thing>
  <thing id="cfgPUTranB" name="Transformed Body" compset="Configure" uniqueness="unique">
    <comment>Aberrant Archetype Configurable</comment>
    <fieldval field="cfgObject1" value="Customization"/>
    <fieldval field="cfgMax1" value="1"/>
    <tag group="abCategory" tag="arPUAberra" name="Transformed Body"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="rcPUaBrawn">
      <autotag group="CustTaken" tag="cfgPUTranB"/>
      </bootstrap>
    <bootstrap thing="rcPUaHardS">
      <autotag group="CustTaken" tag="cfgPUTranB"/>
      </bootstrap>
    <bootstrap thing="raDarkVis">
      <containerreq phase="First" priority="500"><![CDATA[count:Classes.Aegis >= 2]]></containerreq>
      <autotag group="CustTaken" tag="cfgPUTranB"/>
      </bootstrap>
    <bootstrap thing="rcPUaIDamR">
      <containerreq phase="First" priority="500"><![CDATA[count:Classes.Aegis >= 10]]></containerreq>
      <autotag group="CustTaken" tag="cfgPUTranB"/>
      </bootstrap>
    <eval phase="PostLevel" priority="25000"><![CDATA[
      ~ Set focus to Aegis Helper Pick &
      perform hero.childfound[cPUAegHelp].setfocus
      doneif (state.isfocus = 0)

      ~ Set Astral Suit Level from Aegis Helper &
      field[cfgLevel].value = focus.field[abValue].value

      ~ Set Configurable points from Aegis Helper.
      ~ abValue2 is Bonus points and abValue3 is the Base Points.
      field[cfgMax1].value = focus.field[abValue2].value + focus.field[abValue3].value]]>
      <after name="Set Aegis Base Points"/>
      </eval>
    <eval phase="Final" priority="999999" index="2"><![CDATA[
      ~ To make this configurable expression backwards compatabile
      ~ we will include the old AllowRCust.cfgPUTranB tag and
      ~ the new Ability Category tag abCategory.arPUAberra.

      ~ Change the Customiazation expression to include Ability Category tags
      ~ NOTE: This script assumes at least ONE abCategory.? tag exists on the configurable
      ~       at the time that it runs.
      field[cfgAllow1].text = "(" & field[cfgAllow1].text & ") | (" & tagids[abCategory.?,"|"] & ")"]]></eval>
    </thing>
  <thing id="cPUTranBod" name="Transformed Body" description="An aberrant learns to modify his own form, rather than covering himself in an ectoplasmic suit. The aberrant gains a +1 natural armor bonus to his AC. At 5th level and every 5 levels thereafter (10th, 15th, and 20th), the natural armor bonus increases by 1.{br}{br}An aberrant can modify his form in a fashion similar to the aegis&apos;s customization, but his options are more limited. He can choose customizations from the customization list below, as well as new customizations exclusive to the aberrant. Because the aberrant is modifying his own body, he can wear armor as normal.{br}{br}The aberrant gains hardened strikes and brawn as a free customization. At 2nd level, the aberrant gains darkvision as a free customization. At 10th level, the aberrant gains improved damage reduction as a free customization.{br}{br}This ability replaces astral suit." compset="ClSpecial">
    <comment>Aberrant Archetype Ability</comment>
    <fieldval field="actName" value="Transformed"/>
    <tag group="User" tag="Activation"/>
    <tag group="AbilType" tag="Super"/>
    <tag group="SpecType" tag="Defense"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="cfgPUTranB"></bootstrap>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & signed(field[xIndex].value)

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      field[abValue].value += field[xCount].value
      field[livename].text = field[thingname].text & " " & signed(field[abValue].value)

      ~ The following should only happen once on the first copy
      doneif (tagis[Helper.FirstCopy] = 0)

      hero.child[ArmorClass].field[tACNatural].value += field[abValue].value]]></eval>
    <eval phase="First" priority="500" index="2"><![CDATA[
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)
      ~ If not active get out now!
      doneif (field[abilActive].value = 0)

      ~ Being transformed is the same as wearing our Astral Suite
      ~ so set tag on hero.
      perform hero.assign[Custom.WearAstS]]]></eval>
    </thing>
  <thing id="cPUVim" name="Vim" description="The aberrant gains {i}vim{/i} as a psi-like ability usable at will at first level as long as he maintains psionic focus. This ability replaces astral repair." compset="ClSpecial">
    <comment>Aberrant Archetype Ability</comment>
    <tag group="AbilType" tag="PsiLike"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="puVim0">
      <autotag group="Helper" tag="PsiLike"/>
      <autotag group="Usage" tag="AtWill"/>
      </bootstrap>
    </thing>
  <thing id="cPUIntim" name="Intimidate" description="Beginning at 2nd level, an aberrant gains a +1 bonus to Intimidate checks. At 6th level and every four levels thereafter, this bonus increases by 1. This ability replaces craftsman." compset="ClSpecial" summary="Gain listed bonus to intimidate checks.">
    <comment>Aberrant Archetype Ability</comment>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="AbilType" tag="Extra"/>
    <tag group="ChooseSrc1" tag="Hero"/>
    <tag group="SpecType" tag="Skill"/>
    <tag group="LvNameApp" tag="AppValue"/>
    <tag group="LvNameApp" tag="SignAppVal"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & signed(field[xIndex].value)

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      field[abValue].value += field[xCount].value

      ~ The following should only happen once on the first copy
      doneif (tagis[Helper.FirstCopy] = 0)

      #skillbonus[skIntim] += field[abValue].value]]></eval>
    </thing>
  <thing id="cPUPsiForm" name="Psionic Form" description="At 5th level, the aberrant gains 1 hit point for each psionic feat he has. Whenever he takes a new psionic feat, he gains 1 more hit point. These bonus hit points stack with those gained from the Psionic Body feat. This ability replaces Master Craftsman." compset="ClSpecial">
    <comment>Aberrant Archetype Ability</comment>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PreLevel" priority="10000"><![CDATA[
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Add 1 * (number of psionic feats on the hero) to our hit points.
      field[abValue].value += hero.tagcount[fCategory.Psionic]

      ~ Give the bonus HP to the character
      herofield[tHP].value += field[abValue].value]]></eval>
    </thing>
  <thing id="rcPUaDisjo" name="Disjointed" description="The aberrant gains a +2 bonus on Escape Artist checks." compset="CustomSpec" summary="+2 bonus to Escape Artist." uniqueness="useronce">
    <fieldval field="abValue" value="2"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not wearing the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      #skillbonus[skEscape] += field[abValue].value]]></eval>
    </thing>
  <thing id="rcPUaEyest" name="Eyestalks" description="The aberrant&apos;s eyes extend out on a pair of stacks, giving a +2 bonus on Perception checks and low-light vision. The aberrant is also capable of looking around corners while still maintaining cover." compset="CustomSpec" summary="Gain +2 Perception and low-light vision." uniqueness="useronce">
    <fieldval field="abValue" value="2"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="raLowLight">
      <containerreq phase="First" priority="500"><![CDATA[count:hero#Custom.WearAstS  <> 0]]></containerreq>
      </bootstrap>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not wearling the Astral Suit, get out now
      doneif (hero.tagcount[Custom.WearAstS] = 0)

      #skillbonus[skPercep] += field[abValue].value]]></eval>
    </thing>
  <thing id="rcPUaSting" name="Stinger" description="The aberrant gains a stinger that resembles a scorpion&apos;s as a secondary natural attack that deals 1d4 points of piercing damage." compset="CustomSpec" summary="Gain a stinger as a secondary natural attack." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="wSting">
      <autotag group="wMain" tag="1d4"/>
      <autotag group="Helper" tag="NatSecond"/>
      <autotag group="Helper" tag="NoRootName"/>
      </bootstrap>
    </thing>
  <thing id="rcPUaTearS" name="Tearing Sting" description="When the aberrant makes a successful attack with his stinger, it rips the flesh of the target, causing the target to bleed, taking 1 point of damage each round. The aberrant must have the stinger customization before selecting this customization." compset="CustomSpec" uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Set bleed note on the stinger &
      #extradamage[hero.childfound[wSting]," plus one bleed",field[name].text]]]></eval>
    <exprreq message="Stinger customization required."><![CDATA[#hasability[rcPUaSting] <> 0]]></exprreq>
    </thing>
  <thing id="rcPUaTenta" name="Tentacle" description="The aberrant grows a tentacle and gains a secondary natural attack with the tentacle that deals 1d4 points of damage. The aberrant also gains the grab ability and gets a +2 bonus to grab for every tentacle beyond the first he has. This customization can be selected up to 4 times; its benefits stack." compset="CustomSpec" summary="Gain a tentacle as a secondary natural attack." maxlimit="4">
    <fieldval field="abValue" value="2"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="1"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="xxPUaTenta"></bootstrap>
    <bootstrap thing="wTentacle">
      <autotag group="wMain" tag="1d4"/>
      <autotag group="Helper" tag="NatSecond"/>
      <autotag group="Helper" tag="NoRootName"/>
      </bootstrap>
    <eval phase="PostLevel" priority="10000">~ +2 bonus to grab for each tentacle past the
      ~ first one.
      hero.child[manGrapple].field[cmbBonus].value += hero.tagcount[Ability.rcPUaTenta] - 1</eval>
    </thing>
  <thing id="xxPUaTenta" name="Tentacle" description="Helper Pick to make grab only display once" compset="CustomSpec" uniqueness="unique">
    <tag group="Helper" tag="SpecUp"/>
    <tag group="Helper" tag="Helper"/>
    <tag group="Hide" tag="Special"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="raGrab">
      <autotag group="Target" tag="wTentacle"/>
      </bootstrap>
    </thing>
  <thing id="rcPUaObese" name="Obese" description="The aberrant&apos;s base movement is reduced as if wearing heavy armor (for example, 30 ft. becomes 15 ft), but the aberrant gains extra hit points equal to his aberrant level and the aberrant&apos;s damage reduction gained from his transformed body improves by 1." compset="CustomSpec" summary="Gain lvl bonus HP but move slower." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="1000"><![CDATA[
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ DR increses by 1
      #value[cPUAegDR] += 1

      ~ Speed is slow as if wearing armor &
      perform hero.assign[Hero.ArmorSpeed]

      ~ HP Bonus for Aegis levels
      field[abValue].value = #levelcount[Aegis]
      hero.child[Totals].field[tBonusHP].value += field[abValue].value]]></eval>
    </thing>
  <thing id="rcPUaPoiso" name="Poison" description="The aberrant&apos;s stinger attacks deal 1 point of Strength damage (Fortitude negates, DC 10 + 1/2 the aberrant&apos;s level + the aberrant&apos;s Charisma modifier) on a successful attack. The aberrant must have the stinger customization before selecting this customization." compset="CustomSpec" summary="Stinger attack gains a poison effect causing 1 Str dmg." uniqueness="useronce">
    <fieldval field="abText" value="Fort Neg"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="abSave" tag="FortNeg"/>
    <tag group="StandardDC" tag="aCHA"/>
    <tag group="abAction" tag="Attack"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="LvNamePar" tag="AppText"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Set poison note on the stinger &
      #extradamage[hero.childfound[wSting]," plus poison",field[name].text]]]></eval>
    <exprreq message="Stinger customization required."><![CDATA[#hasability[rcPUaSting] <> 0]]></exprreq>
    </thing>
  <thing id="rcPUaINatA" name="Improved Natural Armor" description="The aberrant&apos;s natural armor bonus increases by 1. This customization can be taken once for every five levels the aberrant possesses.{br}{br}The aberrant must be at least 5th level before selecting this customization." compset="CustomSpec" summary="Increase natural AC bonus by 1.">
    <fieldval field="abValue" value="1"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="9000"><![CDATA[
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Increase Transformed Body AC bonus by 1 &
      #value[cPUTranBod] += field[abValue].value]]></eval>
    <prereq message="">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs

        var allowed as number
        allowed = round(levels/5,0,-1) + 1

        ~if we're a pick, then there must be complevel/5 or fewer copies of
        ~ this ability
        If (@ispick <> 0) then
          validif (hero.tagcount[HasAbility.rcPUaINatA] <= allowed)

        ~otherwise, look for fewer, since we're adding this
        Else
          validif (hero.tagcount[HasAbility.rcPUaINatA] < allowed)
        Endif

        @message = "You may not have more than " & allowed & " copies of this ability."]]></validate>
      </prereq>
    </thing>
  <thing id="rcPUaSpike" name="Spikes" description="The aberrant gains the ability to loose a volley of two spikes as a standard action (make an attack roll for each spike). This attack has a range of 180 feet with no range increment and deals 1d6 points of damage plus the aberrant&apos;s Strength modifier (if the aberrant is Medium sized; adjust the damage accordingly if the aberrant is a size other than Medium). All targets must be within 30 feet of each other. The aberrant can launch only 24 spikes in any 24-hour period." compset="CustomSpec" summary="Gain ability to loose a volley of two spikes." uniqueness="useronce">
    <fieldval field="trkMax" value="24"/>
    <usesource source="pPsiUn"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="Usage" tag="Day"/>
    <tag group="User" tag="Tracker"/>
    <bootstrap thing="wSpikes">
      <autotag group="wMain" tag="1d6"/>
      <autotag group="Helper" tag="NatSecond"/>
      <autotag group="Helper" tag="NoRootName"/>
      </bootstrap>
    </thing>
  <thing id="rcPUaTearF" name="Tear Flesh" description="When the aberrant has successfully grabbed a creature with its tentacles, he deals 1d6 damage per attached tentacle when target breaks free, The aberrant must have the tentacles customization before selecting this customization." compset="CustomSpec" summary="Tentacles cause dmg when target breaks grapple." uniqueness="useronce">
    <fieldval field="abValue" value="1"/>
    <fieldval field="abValue2" value="6"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="2"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="LvNameApp" tag="DieCntVal"/>
    <tag group="LvNameApp" tag="SignDieCnt"/>
    <tag group="LvNameApp" tag="DieSizVal2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <exprreq message="Tentacle customization required."><![CDATA[#hasability[rcPUaTenta] <> 0]]></exprreq>
    </thing>
  <thing id="rcPUaToxic" name="Toxic" description="A number of times per day equal to the aberrant&apos;s Constitution modifier (minimum 1/day), the aberrant can envenom a weapon that he wields or one natural attack with toxic saliva. Applying venom in this way is a swift action and the aberrant is immune to this poison.{br}{br}{b}Aberrant Saliva:{/b} Injury; save Fort DC 10 + 1/2 aberrant level + the aberrant&apos;s Constitution modifier; frequency 1/ round for 6 rounds; effect 1d2 Dex; cure 1 save." compset="CustomSpec" summary="Envenom a weapon or natural attack with toxic saliva." uniqueness="useronce">
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="3"/>
    <tag group="Usage" tag="Day"/>
    <tag group="ChargeCalc" tag="AttrOnly"/>
    <tag group="ChargeCalc" tag="Minimum1"/>
    <tag group="ChargeAttr" tag="aCON"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="rcPUaProSh" name="Protective Shell" description="The aberrant gains the ability to form a protective shell around his entire body, but loses his ability to move while it is active. As a full-round action, the aberrant gains heavy fortification and doubles his damage reduction from transformed body, but he cannot make attacks of opportunity. The aberrant must be at least 12th level before selecting this customization." compset="CustomSpec" summary="Gain heavy fortification and 2x DR but you can&apos;t move or make an AoO." uniqueness="useronce">
    <fieldval field="abValue" value="2"/>
    <fieldval field="abValue2" value="75"/>
    <usesource source="pPsiUn"/>
    <tag group="CustomCost" tag="4"/>
    <tag group="User" tag="Activation"/>
    <tag group="abCategory" tag="arPUAberra"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)
      ~ If not active get out now!
      doneif (field[abilActive].value = 0)

      ~ Mutliple DR by 2
      #value2[cPUAegDR] += field[abValue].value

      ~ Apply Fortification to hero
      #applyfort[field[abValue2].value]]]></eval>
    <prereq message="Aegis level 12+ required.">
      <validate><![CDATA[
        var classcheck as string
        var levels as number
        classcheck = "Aegis"
        call PUPreReqs
        validif (levels >= 12)]]></validate>
      </prereq>
    </thing>
  <thing id="arPUCryWar" name="Crystal Warrior" description="Some aegis have learned to form a psicrystal and shape their astral suit around the small creature, creating a sentient suit of armor that grants them many benefits at the cost of some flexibility." compset="ClassVary" uniqueness="unique">
    <fieldval field="srcPageNum" value="262"/>
    <fieldval field="srcBookInf" value="Ultimate Psionics"/>
    <usesource source="pPsiUn"/>
    <tag group="AbReplace" tag="cPUInvigSu"/>
    <tag group="AbReplace" tag="cPUCanniSu"/>
    <tag group="ClVaryName" tag="AppParen"/>
    <tag group="AbReplace" tag="cPUAstrRep"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="cPUPsiAff">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="cPUMissive">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="cPUPsicryC">
      <autotag group="ClSpecWhen" tag="3"/>
      </bootstrap>
    <bootstrap thing="cPUEneBlst">
      <autotag group="ClSpecWhen" tag="4"/>
      </bootstrap>
    <bootstrap thing="cPUPsCShot">
      <autotag group="ClSpecWhen" tag="7"/>
      </bootstrap>
    <bootstrap thing="cPUTacSuit">
      <autotag group="ClSpecWhen" tag="12"/>
      </bootstrap>
    <bootstrap thing="cPUTacSuit">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="cPUTacSuit">
      <autotag group="ClSpecWhen" tag="16"/>
      </bootstrap>
    <bootstrap thing="cPUTacSuit">
      <autotag group="ClSpecWhen" tag="18"/>
      </bootstrap>
    <bootstrap thing="cPUTacSuit">
      <autotag group="ClSpecWhen" tag="20"/>
      </bootstrap>
    <link linkage="varies" thing="cHelpPU0"/>
    <eval phase="Final" priority="9999"><![CDATA[
      #appenddesc[cPUAstSuit,"{b}Modification from Crystal Warrior{/b}: To gain the benefits of some of the additional class features detailed below, the aegis's psicrystal must be physically touching the aegis when the aegis forms his astral suit, and the psicrystal is consumed by the astral suit while the astral suit is active.{br}{br}When the psicrystal is consumed in this fashion, it still grants all the normal benefits for being within 5 ft. of the aegis (Alertness, etc), but the aegis does not gain any of the psicrystal's special abilities (natural armor, hardness, etc.) The aegis may still form his astral suit normally, but he loses those abilities detailed below that rely upon the psicrystal being consumed by the astral suit.{br}{br}In addition, the aegis gains the ranged attack customization as a bonus customization."]

      hero.childfound[cPUPerfMer].field[CustDesc].text = "An aegis of 20th level has learned to become one with his suit. His suit cannot be dispelled or removed against his will by any means, although his astral suit ability still does not function within areas where psionics do not work, such as a null psionics field.{br}{br}In addition, the aegis can spend two daily uses of his reconfigure ability, to alter all of the customizations on his astral suit."]]></eval>
    <eval phase="PreLevel" priority="100000" index="2"><![CDATA[
      ~ Disable the 7th level Reconfigure only
      perform hero.findchild[BaseClSpec,"thingid.cPUReconfi & SpecSource.cHelpPU0 & ClSpecWhen.7"].assign[Helper.SpcDisable]
      perform hero.findchild[BaseClSpec,"thingid.cPUReconfi & SpecSource.cHelpPU0 & ClSpecWhen.7"].assign[Helper.SpcReplace]]]></eval>
    </thing>
  <thing id="cPUPsiAff" name="Psicrystal Affinity" description="The aegis gains the Psicrystal Affinity feat as a bonus feat at 1st level. For the purposes of his psicrystal&apos;s abilities and the feat&apos;s prerequisites, the aegis&apos;s class level counts as his manifester level. This ability replaces one of the customization points gained at 1st level." compset="ClSpecial" summary="Gain Psicyrstal Affinity feat.">
    <comment>Crystal Warrior archetype ability</comment>
    <fieldval field="actName" value="Psicrystal Subsumed"/>
    <tag group="SpecType" tag="Defense"/>
    <tag group="Helper" tag="SpecUp"/>
    <tag group="User" tag="Activation"/>
    <tag group="Custom" tag="PcrySub" name="Psicrystal Subsumed"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="AbilType" tag="Super"/>
    <bootstrap thing="rcPUaRngAt">
      <containerreq phase="First" priority="500"><![CDATA[(count:hero#Custom.PcrySub + count:hero#Custom.WearAstS = 2) & (count:Classes.Aegis >= 1)]]></containerreq>
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <bootstrap thing="fPUPsicry"></bootstrap>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Decrease aegis customization points
      #value2[cPUAegHelp] -=1]]></eval>
    <eval phase="First" index="2"><![CDATA[
      ~ if we've been disabled, get out now &
      doneif (tagis[Helper.SpcDisable] <> 0)
      ~ If not activated get out now!
      doneif (field[abilActive].value = 0)

      ~ Set hero tag for Psicyrstal Subsumed
      perform forward[Custom.PcrySub]]]></eval>
    </thing>
  <thing id="cPUMissive" name="Missive" description="While the aegis&apos;s astral suit is active and his psicrystal is consumed by it, he gains the ability to use {i}missive{/i} as a psi-like ability with a manifester level equal to his class level. This ability replaces astral repair." compset="ClSpecial" summary="Gain missive power as a psi-like ability.">
    <comment>Crystal Warrior archetype ability</comment>
    <fieldval field="abValue" value="2"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="AbilType" tag="PsiLike"/>
    <bootstrap thing="puMissive0">
      <containerreq phase="First" priority="500">count:hero#Custom.PcrySub + count:hero#Custom.WearAstS = 2</containerreq>
      <autotag group="Helper" tag="PsiLike"/>
      <autotag group="Usage" tag="AtWill"/>
      </bootstrap>
    </thing>
  <thing id="cPUPsicryC" name="Psicrystal Containment" description="The aegis gains the Psicrystal Containment feat as a bonus feat at 3rd level. For the purposes of the feat&apos;s prerequisites, the aegis&apos;s class level counts as his manifester level. This ability replaces invigorating suit." compset="ClSpecial" summary="Gain Psicrystal Containment feat.">
    <comment>Crystal Warrior archetype ability</comment>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="Helper" tag="SpecUp"/>
    <bootstrap thing="fPUPsicryC">
      <containerreq phase="First" priority="500"><![CDATA[count:Classes.Aegis >= 3 & !AbReplace.cPUPsicryC]]></containerreq>
      <autotag group="thing" tag="skipprereq"/>
      </bootstrap>
    </thing>
  <thing id="cPUEneBlst" name="Energy Blast" description="Starting at 4th level, the aegis gains the energy blast customization when his psicrystal is consumed by the astral suit. This ability replaces one of the customization points normally gained at 4th level." compset="ClSpecial" summary="Gain the engery blast customization.">
    <comment>Crystal Warrior archetype ability</comment>
    <tag group="ProductId" tag="HLCommunit"/>
    <tag group="Helper" tag="SpecUp"/>
    <bootstrap thing="rcPUaEneBl">
      <containerreq phase="First" priority="500"><![CDATA[(count:hero#Custom.PcrySub + count:hero#Custom.WearAstS = 2) & (count:Classes.Aegis >= 4)]]></containerreq>
      <autotag group="CustTaken" tag="cfgPUAstSu"/>
      </bootstrap>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ Decrease aegis customization points
      #value2[cPUAegHelp] -=1]]></eval>
    </thing>
  <thing id="cPUPsCShot" name="Psicrystal Shot" description="At 7th level, when the aegis&apos;s psicrystal is consumed by the astral suit, the psicrystal can use its own actions to aid the aegis in combat. The psicrystal can use the attack options from the ranged attack customization, including any customizations that improve the ranged attack, such as energy blast. Use the crystal warrior&apos;s base attack bonus, as calculated from all his classes, and the psicrystal&apos;s Dexterity modifier to calculate the psicrystal&apos;s attack bonus. Treat its Dexterity as if it was under the self-propulsion effect. This ability replaces the daily use of reconfigure normally gained at 7th level.\n\n{b}Note:{/b} Not fully implemented (TODO)." compset="ClSpecial">
    <comment>Crystal Warrior archetype ability</comment>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="cPUTacSuit" name="Tactical Suit" description="Beginning at 12th level, once per day while his astral suit is active and the psicrystal is consumed by it, the aegis can expend his psionic focus to be treated as if under the {i}battlesense{/i} power, with a manifester level equal to half his class level. The power is manifested as if the aegis had spent a number of power points equal to the effect&apos;s manifester level. The aegis gains any benefits from the list of special abilities of {i}battlesense{/i} as if he was a member of the manifester&apos;s collective, but no other creatures gain the benefits of the power. The aegis can spend a standard action to alter the benefit of the power. Every two levels thereafter, the aegis can use this ability an additional time per day. This ability replaces cannibalize suit." compset="ClSpecial" summary="Expend focus to be treated as if under the {i}battlesense{/i} power.">
    <comment>Crystal Warrior archetype ability</comment>
    <tag group="AbilType" tag="Super"/>
    <tag group="abAction" tag="PUExpFocus"/>
    <tag group="Usage" tag="Day"/>
    <tag group="DescInfo" tag="puBattl3"/>
    <tag group="User" tag="Tracker"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & field[xIndex].value & "/day"

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      field[trkMax].value += field[xCount].value

      ~ Calculate Half ML
      field[abValue].value += round(field[xTotalLev].value/2,0,-1)

      ~ Format Display name
      field[livename].text = field[thingname].text & " (ML " & field[abValue].value & ")"]]></eval>
    </thing>
  <thing id="arPUEctArt" name="Ectopic Artisan" description="A shaper and an aegis both use ectoplasm to achieve their desired goals. The rare aegis has learned to blend the tools of the shaper into his own skills, but by doing so he reduces the power of his astral suit. These ectopic artisans gain allies formed of ectoplasm to aid them in battle.{br}{br}{b}Class Skills:{/b} The ectopic adept gains Disable Device as a class skill." compset="ClassVary" uniqueness="unique">
    <fieldval field="srcPageNum" value="263"/>
    <fieldval field="srcBookInf" value="Ultimate Psionics"/>
    <usesource source="pPsiUn"/>
    <tag group="AbReplace" tag="cPUAegDR"/>
    <tag group="AbReplace" tag="cPUReconfi"/>
    <tag group="AbReplace" tag="cPUCanniSu"/>
    <tag group="AbReplace" tag="cPUMastCr"/>
    <tag group="ClassSkill" tag="skDisable"/>
    <tag group="ClVaryName" tag="AppParen"/>
    <tag group="AbReplace" tag="cPUAstrRep"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <bootstrap thing="cPUAstrMan">
      <autotag group="ClSpecWhen" tag="1"/>
      </bootstrap>
    <bootstrap thing="cPUEctCre">
      <autotag group="ClSpecWhen" tag="2"/>
      </bootstrap>
    <bootstrap thing="cPUAstWarr">
      <autotag group="ClSpecWhen" tag="3"/>
      </bootstrap>
    <bootstrap thing="cPUCoStrik">
      <autotag group="ClSpecWhen" tag="5"/>
      </bootstrap>
    <bootstrap thing="cPUAstSwar">
      <autotag group="ClSpecWhen" tag="12"/>
      </bootstrap>
    <bootstrap thing="cPUAstSwar">
      <autotag group="ClSpecWhen" tag="14"/>
      </bootstrap>
    <bootstrap thing="cPUAstSwar">
      <autotag group="ClSpecWhen" tag="16"/>
      </bootstrap>
    <bootstrap thing="cPUAstSwar">
      <autotag group="ClSpecWhen" tag="18"/>
      </bootstrap>
    <bootstrap thing="cPUAstSwar">
      <autotag group="ClSpecWhen" tag="20"/>
      </bootstrap>
    <link linkage="varies" thing="cHelpPU0"/>
    <eval phase="Final" priority="9999"><![CDATA[
      hero.childfound[cPUPerfMer].field[CustDesc].text = "An aegis of 20th level has learned to become one with his suit. His suit cannot be dispelled or removed against his will by any means, although his astral suit ability still does not function within areas where psionics do not work, such as a null psionics field.{br}{br}In addition, the aegis can spend two daily uses of his reconfigure ability, to alter all of the customizations on his astral suit."]]></eval>
    </thing>
  <thing id="cPUAstrMan" name="Astral Manipulation" description="The ectopic artisan can, with a touch, restore an object&apos;s hit points or cause damage. As a standard action, the ectopic artisan can touch an object and either deal 2 hit points of damage to the object or heal 2 hit points of damage, although broken objects cannot be repaired in this fashion. Damage dealt to objects is not subject to object hardness.{br}{br}This ability replaces {i}astral repair{/i}." compset="ClSpecial" summary="Restore/Deal HP dmg to object touched.">
    <fieldval field="abValue" value="2"/>
    <tag group="AbilType" tag="Super"/>
    <tag group="ProductId" tag="HLCommunit"/>
    <eval phase="PostLevel" priority="20000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      field[livename].text = field[thingname].text & " (" & field[abValue].value & " HP Dmg)"


      field[abSumm].text = "Restore/Deal " & field[abValue].value & " HP dmg to object touched."]]></eval>
    </thing>
  <thing id="cPUEctCre" name="Ectoplasmic Creation" description="An ectopic adept of 2nd level is able to shape ectoplasm for a myriad of uses, gaining the ability to manifest {i}ectoplasmic creation{/i} as a psi-like ability with a manifester level equal to half his class level a number of times per day equal to his Intelligence modifier.{br}{br}At 11th level, the ectopic adept can instead manifest {i}major ectoplasmic creation{/i} as a psi-like ability with a manifester level equal to his class level." compset="ClSpecial" summary="Gain powers to shape ectoplasm.">
    <tag group="AbilType" tag="PsiLike"/>
    <bootstrap thing="puEctoCre1">
      <containerreq phase="First" priority="500"><![CDATA[(count:Classes.Aegis >= 2) & (count:Classes.Aegis < 11)]]></containerreq>
      <autotag group="Helper" tag="PsiLike"/>
      <autotag group="Usage" tag="Day"/>
      </bootstrap>
    <bootstrap thing="puEctoCrM5">
      <containerreq phase="First" priority="500"><![CDATA[count:Classes.Aegis >= 11]]></containerreq>
      <autotag group="Helper" tag="PsiLike"/>
      <autotag group="Usage" tag="Day"/>
      </bootstrap>
    <eval phase="PostAttr" priority="10000"><![CDATA[
      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      ~ ML of powers is half-level
      field[abValue].value += round(field[xTotalLev].value/2,0,-1)

      ~ Uses per day is equal to Int Modifier
      field[trkMax].value += #attrmod[aINT]

      field[livename].text = field[thingname].text & " (ML: " & field[abValue].value & ", " & field[trkMax].value & "/day)"]]></eval>
    <eval phase="Final" priority="999999999" index="2">
      ~ Set ML on powers
      hero.childfound[puEctoCre1].field[sCL].value = field[abValue].value
      hero.childfound[puEctoCrM5].field[sCL].value = field[abValue].value</eval>
    </thing>
  <thing id="cPUAstWarr" name="Astral Warrior" description="An ectopic artisan of 3rd level is able to create an ally to aid him in battle. Creating an astral warrior takes one minute of concentration to complete and the astral warrior remains until dismissed by the ectopic artisan.\n\nThis astral warrior functions as a summoner&apos;s eidolon using the ectopic artisan&apos;s class level as the summoner level, with some differences. The astral warrior uses the biped base form of the eidolon, but does not gain any of the natural attacks of the eidolon, nor does it gain any evolution points of its own. Instead, it is created with a masterwork weapon appropriate for its size and is considered proficient with the weapon. The weapon&apos;s damage type (bludgeoning, piercing, or slashing) is chosen by the ectopic artisan at the time of creation, but the weapon always deals 1d8 points of damage (for a medium sized creature). The astral warrior receives additional iterative attacks as normal if it has a high base attack bonus. The astral warrior&apos;s weapon disappears if it leaves the astral warrior&apos;s possession for more than one minute.\n\nThe ectopic artisan and the astral warrior split the total customization points available to the ectopic artisan, chosen when the ectopic artisan configures his astral suit.\n\nThe ectopic artisan can split his customization points in any ratio between himself and his astral warrior. The ectopic artisan must choose customizations separately for himself and for his astral warrior, although the ectopic artisan does not need to spend 8 hours separately for himself and for his astral warrior. The ectopic artisan can choose to leave customization points to be selected later as normal, choosing them for either himself or his astral warrior by spending one minute as normal. An astral warrior always forms with full hit points, and the astral warrior does not gain any evolutions.\n\nAn astral warrior is a mindless construct. Commanding an astral warrior is the same as commanding an astral construct.\n\nAn astral warrior disperses if the ectopic artisan is rendered unconscious or dies.\n\nThis ability replaces reconfigure.\n\n{b}Note:{/b} This is not fully implemented yet.(TODO)" compset="ClSpecial">
    <tag group="AbilType" tag="PsiLike"/>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="cPUCoStrik" name="Cocooning Strike" description="The ectopic artisan gains a permanent customization that triggers on a critical hit while his astral suit is active. When triggered, the target is affected by {i}ectoplasmic cocoon{/i} (Reflex save DC 10 + half the aegis&apos;s level + the aegis&apos;s Intelligence modifier to negate). This effect only works on Large or smaller creatures. This ability can only be triggered once per round. The ectopic artisan can grant this customization to his astral warrior when it is created, but he loses access to it while the astral warrior is active and has been granted the customization. This ability replaces Master Craftsman." compset="ClSpecial" summary="Use {i}ecotoplasimic cocoon{/i} as a psi-like ability.">
    <usesource source="pPsiUn"/>
    <tag group="SpecType" tag="Defense"/>
    <tag group="DescInfo" tag="puEctoCoc3"/>
    <tag group="AbilType" tag="Super"/>
    <tag group="abSave" tag="RefNeg"/>
    <tag group="StandardDC" tag="aINT"/>
    <tag group="ProductId" tag="HLCommunit"/>
    </thing>
  <thing id="cPUAstSwar" name="Astral Swarm" description="An ectopic artisan of 12th level can create an astral swarm once per day (see Appendix).{br}{br}Every even level thereafter (14th,16th, 18th, and 20th), the ectopic artisan gains an additional daily use of this ability. This ability replaces cannibalize suit." compset="ClSpecial" summary="Create an astral swarm.">
    <usesource source="pPsiUn"/>
    <tag group="SpecType" tag="Defense"/>
    <tag group="AbilType" tag="Super"/>
    <tag group="User" tag="Tracker"/>
    <tag group="Usage" tag="Day"/>
    <eval phase="PostLevel" priority="10000"><![CDATA[
      ~ Set the list name
      field[listname].text = field[thingname].text & " " & field[xIndex].value & "/day"

      ~ If we're not shown, just get out now
      doneif (tagis[Helper.ShowSpec] <> 1)
      ~ if we've been disabled, get out now
      doneif (tagis[Helper.SpcDisable] <> 0)

      field[abValue].value += field[xCount].value
      field[livename].text = field[thingname].text & " " & field[abValue].value

      ~ The following should only happen once on the first copy
      doneif (tagis[Helper.FirstCopy] = 0)

      field[trkMax].value += field[abValue].value
      ]]></eval>
    </thing>
  </document>
